<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>ladybug.comfort.pmv API documentation</title>
    <meta name="description" content="PMV Comfort object." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#ladybug.comfort.pmv.PMV">PMV</a></span>
        
          
  <ul>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.comfPMV">comfPMV</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.comfPierceSET">comfPierceSET</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.findPMV">findPMV</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.findPPD">findPPD</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.__init__">__init__</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.buildCustomHeader">buildCustomHeader</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.calcMissingPMVInput">calcMissingPMVInput</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.fromEPWFile">fromEPWFile</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.fromIndividualValues">fromIndividualValues</a></li>
    <li class="mono"><a href="#ladybug.comfort.pmv.PMV.setComfortPar">setComfortPar</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">ladybug.comfort.pmv</span> module</h1>
  <p>PMV Comfort object.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;PMV Comfort object.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">.comfortBase</span> <span class="kn">import</span> <span class="n">ComfortModel</span>
<span class="kn">from</span> <span class="nn">..psychrometrics</span> <span class="kn">import</span> <span class="n">findHumidRatio</span>
<span class="kn">from</span> <span class="nn">..psychrometrics</span> <span class="kn">import</span> <span class="n">findSaturatedVaporPressureTorr</span>
<span class="kn">from</span> <span class="nn">..rootFinding</span> <span class="kn">import</span> <span class="n">secant</span>
<span class="kn">from</span> <span class="nn">..rootFinding</span> <span class="kn">import</span> <span class="n">bisect</span>
<span class="kn">from</span> <span class="nn">..listoperations</span> <span class="kn">import</span> <span class="n">duplicate</span>
<span class="kn">from</span> <span class="nn">..epw</span> <span class="kn">import</span> <span class="n">EPW</span>


<span class="k">class</span> <span class="nc">PMV</span><span class="p">(</span><span class="n">ComfortModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PMV Comfort Object.</span>

<span class="sd">    Usage:</span>
<span class="sd">        from ladybug.comfort.pmv import PMV</span>

<span class="sd">        # Compute PMV for a single set of values.</span>
<span class="sd">        myPmvComf = PMV.fromIndividualValues(26, 26, 0.75, 80, 1.1, 0.5)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">        # Compute PMV for a list of data.</span>
<span class="sd">        airTemp = [10, 12, 15, 18, 19]</span>
<span class="sd">        relHumid = [75, 70, 60, 50, 45]</span>
<span class="sd">        myPmvComf = PMV(airTemp, [], [], relHumid)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">        # Compute PMV for all hours of an EPW file.</span>
<span class="sd">        epwFileAddress = &quot;C:/ladybug/New_York_J_F_Kennedy_IntL_Ar_NY_USA/New_York_J_F_Kennedy_IntL_Ar_NY_USA.epw&quot;</span>
<span class="sd">        myPmvComf = PMV.fromEPWFile(epwFileAddress, 1.4, 1.0)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="p">[],</span> <span class="n">windSpeed</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">relHumidity</span><span class="o">=</span><span class="p">[],</span> <span class="n">metRate</span><span class="o">=</span><span class="p">[],</span> <span class="n">cloValue</span><span class="o">=</span><span class="p">[],</span> <span class="n">externalWork</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a PMV comfort object from lists of PMV inputs.&quot;&quot;&quot;</span>
        <span class="c1"># Assign all of the input values to the PMV comfort model object.</span>
        <span class="c1"># And assign defaults if nothing has been connected.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>

        <span class="k">if</span> <span class="n">radTemperature</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">radTemperature</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span>

        <span class="k">if</span> <span class="n">windSpeed</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">windSpeed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">relHumidity</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">relHumidity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">metRate</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">metRate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cloValue</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">cloValue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">externalWork</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">externalWork</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Default variables that all comfort models have.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerStr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># Set default comfort parameters for the PMV model.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="mf">0.1</span>

        <span class="c1"># Set blank values for the key returns of the class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromIndividualValues</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">windSpeed</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">relHumidity</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
                             <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from individual values.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">airTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">airTemperature</span> <span class="o">=</span> <span class="mf">20.0</span>
        <span class="k">if</span> <span class="n">radTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">radTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>
        <span class="k">if</span> <span class="n">windSpeed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">windSpeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">relHumidity</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">relHumidity</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">pmvModel</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">airTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">relHumidity</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">metRate</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">cloValue</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">externalWork</span><span class="p">)])</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">pmvModel</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromEPWFile</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">epwFileAddress</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
                    <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inclHeader</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from the conditions within an EPW file.</span>

<span class="sd">        Args:</span>
<span class="sd">            metRate: A value representing the metabolic rate of the human subject in met.</span>
<span class="sd">                1 met = resting seated. If list is empty, default is set to 1 met.</span>
<span class="sd">            cloValue: A lvalue representing the clothing level of the human subject in clo.</span>
<span class="sd">                1 clo = three-piece suit. If list is empty, default is set to 1 clo.</span>
<span class="sd">            externalWork: A value representing the work done by the human subject in met.</span>
<span class="sd">                1 met = resting seated. If list is empty, default is set to 0 met.</span>
<span class="sd">            header: set to &quot;True&quot; to have a ladybug header included in the output and set to</span>
<span class="sd">                &quot;False&quot; to remove the header.  The default is set to &quot;True.&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">epwData</span> <span class="o">=</span> <span class="n">EPW</span><span class="p">(</span><span class="n">epwFileAddress</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">windSpeed</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">relativeHumidity</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="p">[</span><span class="n">metRate</span><span class="p">],</span> <span class="p">[</span><span class="n">cloValue</span><span class="p">],</span> <span class="p">[</span><span class="n">externalWork</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isReCalculationNeeded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean value that indicates whether the comfort values need to be re-computed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True = re-calculation is needed before comfort values can be output.</span>
<span class="sd">            False = no re-calculation is needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isDataAligned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether the input data is aligned.</span>
<span class="sd">            True = aligned</span>
<span class="sd">            False = not aligned (run the _checkAndAlignLists function to align the data)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isHeaderIncluded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether a header will be output on the results.</span>
<span class="sd">            True = header included.</span>
<span class="sd">            False = header not included.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">singleValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether single values or a list of values will be output.</span>
<span class="sd">            True = single values output.</span>
<span class="sd">            False = lists of values output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">airTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing dry bulb temperatures in degrees Celcius.</span>
<span class="sd">        This can be a list with a LB header on it.  If list is empty, default is set to 20 C.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span>

    <span class="nd">@airTemperature.setter</span>
    <span class="k">def</span> <span class="nf">airTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="k">else</span> <span class="n">value</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing mean radiant temperatures in degrees Celcius.</span>
<span class="sd">        This list can have a LB header on it.  If list is empty, default is set be the same as __airTemperature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span>

    <span class="nd">@radTemperature.setter</span>
    <span class="k">def</span> <span class="nf">radTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">windSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing wind speeds in m/s. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0 m/s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span>

    <span class="nd">@windSpeed.setter</span>
    <span class="k">def</span> <span class="nf">windSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">relHumidity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing relative humidities in %. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 50%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span>

    <span class="nd">@relHumidity.setter</span>
    <span class="k">def</span> <span class="nf">relHumidity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the metabolic rate of the human subject in met.</span>
<span class="sd">        1 met = resting seated. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 1.1 met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span>

    <span class="nd">@metRate.setter</span>
    <span class="k">def</span> <span class="nf">metRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cloValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the clothing level of the human subject in clo.</span>
<span class="sd">        1 clo = three-piece suit. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0.85 clo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span>

    <span class="nd">@cloValue.setter</span>
    <span class="k">def</span> <span class="nf">cloValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">externalWork</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the work done by the human subject in met.</span>
<span class="sd">        This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0 met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span>

    <span class="nd">@externalWork.setter</span>
    <span class="k">def</span> <span class="nf">externalWork</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PPDComfortThresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the threshold of the percentage of people dissatisfied (PPD)</span>
<span class="sd">        beyond which the conditions are not comfortable.  The default is 10%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span>

    <span class="nd">@PPDComfortThresh.setter</span>
    <span class="k">def</span> <span class="nf">PPDComfortThresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">humidRatioUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the upper boundary of humidity ratio above which conditions are considered too</span>
<span class="sd">        humid to be comfortable.  The default is set to 0.03 kg wather/kg air.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@humidRatioUp.setter</span>
    <span class="k">def</span> <span class="nf">humidRatioUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">humidRatioLow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the lower boundary of humidity ratio below which conditions are considered too</span>
<span class="sd">        dry to be comfortable.  The default is set to 0 kg wather/kg air.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@humidRatioLow.setter</span>
    <span class="k">def</span> <span class="nf">humidRatioLow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stillAirThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the wind speed beyond which the formula for Standard Effective Temperature (SET)</span>
<span class="sd">        is used to dtermine PMV/PPD (as opposed to Fanger&#39;s original equation).</span>
<span class="sd">        The default is set to 0.1 m/s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@stillAirThreshold.setter</span>
    <span class="k">def</span> <span class="nf">stillAirThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">setComfortPar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PPDComfortThresh</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">humidRatioUp</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">humidRatioLow</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stillAirThreshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set all of the comfort parameters of the comfort model at once.  These are:</span>
<span class="sd">            PPDComfortThresh</span>
<span class="sd">            humidRatioUp</span>
<span class="sd">            humidRatioLow</span>
<span class="sd">            stillAirThreshold</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="n">PPDComfortThresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="n">humidRatioUp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="n">humidRatioLow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="n">stillAirThreshold</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">_checkAndAlignLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to be sure that the lists of PMV input variables are aligned and fills in defaults where possible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check each list to be sure that the contents are what we want.</span>
        <span class="n">checkData1</span><span class="p">,</span> <span class="n">airTemp</span><span class="p">,</span> <span class="n">airMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="s2">&quot;airTemperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
        <span class="n">checkData2</span><span class="p">,</span> <span class="n">radTemp</span><span class="p">,</span> <span class="n">radMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">,</span> <span class="n">airTemp</span><span class="p">,</span> <span class="s2">&quot;radTemperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
        <span class="n">checkData3</span><span class="p">,</span> <span class="n">windSpeed</span><span class="p">,</span> <span class="n">windMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;windSpeed&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind Speed&quot;</span><span class="p">)</span>
        <span class="n">checkData4</span><span class="p">,</span> <span class="n">relHumid</span><span class="p">,</span> <span class="n">humidMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">,</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">],</span> <span class="s2">&quot;relHumidity&quot;</span><span class="p">,</span> <span class="s2">&quot;Humidity&quot;</span><span class="p">)</span>
        <span class="n">checkData5</span><span class="p">,</span> <span class="n">metRate</span><span class="p">,</span> <span class="n">metMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">],</span> <span class="s2">&quot;metabolicRate&quot;</span><span class="p">,</span> <span class="s2">&quot;Metabolic&quot;</span><span class="p">)</span>
        <span class="n">checkData6</span><span class="p">,</span> <span class="n">cloLevel</span><span class="p">,</span> <span class="n">cloMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">],</span> <span class="s2">&quot;clothingValue&quot;</span><span class="p">,</span> <span class="s2">&quot;Clothing&quot;</span><span class="p">)</span>
        <span class="n">checkData7</span><span class="p">,</span> <span class="n">exWork</span><span class="p">,</span> <span class="n">exMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;externalWork&quot;</span><span class="p">,</span> <span class="s2">&quot;Work&quot;</span><span class="p">)</span>

        <span class="c1"># Finally, for those lists of length greater than 1, check to make sure that they are all the same length.</span>
        <span class="n">checkData</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">checkData1</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData2</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData3</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData4</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData5</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData6</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData7</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">listLenCheck</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">airTemp</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">radTemp</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relHumid</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metRate</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cloLevel</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exWork</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">listLenCheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">listLenCheck</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">checkData</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="n">listLenCheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">airTemp</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">airTemp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">radTemp</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">radTemp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">windSpeed</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">relHumid</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">relHumid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">metRate</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">metRate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">cloLevel</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">cloLevel</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">exWork</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">exWork</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;If you have put in lists with multiple values, the lengths of these lists must match </span><span class="se">\n</span><span class="s1"> across the parameters or you have a single value for a given parameter to be applied to all values in the list.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">checkData</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># If everything is good, re-assign the lists of input variables and set the list alignment to true.</span>
        <span class="k">if</span> <span class="n">checkData</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># Assign all of the input values to the PMV comfort model object.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="n">airTemp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">radTemp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">windSpeed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">relHumid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">metRate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">cloLevel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">exWork</span>
            <span class="c1"># Set the alighed data value to true.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">findPPD</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            pmv: The predicted mean vote (PMV) for which you want to know the PPD.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ppd: The percentage of people dissatisfied (PPD) for the input PMV.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">findPMV</span><span class="p">(</span><span class="n">ppd</span><span class="p">,</span> <span class="n">ppdError</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ppd: The percentage of people dissatisfied (PPD) for which you want to know the possible PMV.</span>
<span class="sd">            ppdError: The acceptable error in meeting the target PPD.  The default is set to 0.001.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv: A list with the two predicted mean vote (PMV) values that produces the input PPD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ppd</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">pmvLow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="n">pmvMid</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pmvHi</span> <span class="o">=</span> <span class="mi">3</span>

            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">((</span><span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ppd</span><span class="p">)</span>

            <span class="c1"># Solve for the missing lower PMV value.</span>
            <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pmvLowSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="c1"># Solve for the missing higher PMV value.</span>
            <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pmvHiSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">pmvLowSolution</span><span class="p">,</span> <span class="n">pmvHiSolution</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;A ppd lower than 5</span><span class="si">% i</span><span class="s1">s not achievable with the PMV model.&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">comfPMV</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Original Fanger function to compute PMV.  Only intended for use with low air speeds (&lt;0.1 m/s).</span>

<span class="sd">        Args:</span>
<span class="sd">            ta: air temperature (C)</span>
<span class="sd">            tr: mean radiant temperature (C)</span>
<span class="sd">            vel: relative air velocity (m/s)</span>
<span class="sd">            rh: relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met: metabolic rate (met)</span>
<span class="sd">            clo: clothing (clo)</span>
<span class="sd">            wme: external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv: predicted mean vote</span>
<span class="sd">            ppd: percentage of people dissatisfied.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pa</span> <span class="o">=</span> <span class="n">rh</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">16.6536</span> <span class="o">-</span> <span class="mf">4030.183</span> <span class="o">/</span> <span class="p">(</span><span class="n">ta</span> <span class="o">+</span> <span class="mi">235</span><span class="p">))</span>

        <span class="n">icl</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># thermal insulation of the clothing in M2K/W</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># metabolic rate in W/M2</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">wme</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># external work in W/M2</span>
        <span class="n">mw</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">w</span>  <span class="c1"># internal heat production in the human body</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">icl</span> <span class="o">&lt;=</span> <span class="mf">0.078</span><span class="p">):</span>
            <span class="n">fcl</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.29</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fcl</span> <span class="o">=</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.645</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>

        <span class="c1"># heat transf. coeff. by forced convection</span>
        <span class="n">hcf</span> <span class="o">=</span> <span class="mf">12.1</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vel</span><span class="p">)</span>
        <span class="n">taa</span> <span class="o">=</span> <span class="n">ta</span> <span class="o">+</span> <span class="mi">273</span>
        <span class="n">tra</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">+</span> <span class="mi">273</span>
        <span class="n">tcla</span> <span class="o">=</span> <span class="n">taa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">35.5</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.5</span> <span class="o">*</span> <span class="n">icl</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="n">p1</span> <span class="o">=</span> <span class="n">icl</span> <span class="o">*</span> <span class="n">fcl</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">3.96</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">p4</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">taa</span>
        <span class="n">p5</span> <span class="o">=</span> <span class="p">(</span><span class="mf">308.7</span> <span class="o">-</span> <span class="mf">0.028</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">50</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.00015</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xn</span> <span class="o">-</span> <span class="n">xf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="n">xf</span> <span class="o">=</span> <span class="p">(</span><span class="n">xf</span> <span class="o">+</span> <span class="n">xn</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">hcn</span> <span class="o">=</span> <span class="mf">2.38</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">xf</span> <span class="o">-</span> <span class="n">taa</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">hcf</span> <span class="o">&gt;</span> <span class="n">hcn</span><span class="p">):</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="n">hcf</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="n">hcn</span>
            <span class="n">xn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p5</span> <span class="o">+</span> <span class="n">p4</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">-</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">*</span> <span class="n">hc</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">):</span>
                <span class="k">print</span> <span class="s1">&#39;Max iterations exceeded&#39;</span>
                <span class="k">return</span> <span class="mi">1</span>

        <span class="n">tcl</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">xn</span> <span class="o">-</span> <span class="mi">273</span>

        <span class="c1"># heat loss diff. through skin</span>
        <span class="n">hl1</span> <span class="o">=</span> <span class="mf">3.05</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5733</span> <span class="o">-</span> <span class="p">(</span><span class="mf">6.99</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
        <span class="c1"># heat loss by sweating</span>
        <span class="k">if</span> <span class="n">mw</span> <span class="o">&gt;</span> <span class="mf">58.15</span><span class="p">:</span>
            <span class="n">hl2</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="mf">58.15</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hl2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># latent respiration heat loss</span>
        <span class="n">hl3</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="o">*</span> <span class="mf">0.00001</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5867</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
        <span class="c1"># dry respiration heat loss</span>
        <span class="n">hl4</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">34</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
        <span class="c1"># heat loss by radiation</span>
        <span class="n">hl5</span> <span class="o">=</span> <span class="mf">3.96</span> <span class="o">*</span> <span class="n">fcl</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xn</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="c1"># heat loss by convection</span>
        <span class="n">hl6</span> <span class="o">=</span> <span class="n">fcl</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcl</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>

        <span class="n">ts</span> <span class="o">=</span> <span class="mf">0.303</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.036</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.028</span>
        <span class="n">pmv</span> <span class="o">=</span> <span class="n">ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="n">hl1</span> <span class="o">-</span> <span class="n">hl2</span> <span class="o">-</span> <span class="n">hl3</span> <span class="o">-</span> <span class="n">hl4</span> <span class="o">-</span> <span class="n">hl5</span> <span class="o">-</span> <span class="n">hl6</span><span class="p">)</span>
        <span class="n">ppd</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

        <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmv</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ppd</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">comfPierceSET</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ta, air temperature (C)</span>
<span class="sd">            tr, mean radiant temperature (C)</span>
<span class="sd">            vel, relative air velocity (m/s)</span>
<span class="sd">            rh, relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met, metabolic rate (met)</span>
<span class="sd">            clo, clothing (clo)</span>
<span class="sd">            wme, external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            set, standard effective temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Key initial variables.</span>
        <span class="n">VaporPressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">rh</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">ta</span><span class="p">))</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="n">AirVelocity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vel</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">KCLO</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">BODYWEIGHT</span> <span class="o">=</span> <span class="mf">69.9</span>
        <span class="n">BODYSURFACEAREA</span> <span class="o">=</span> <span class="mf">1.8258</span>
        <span class="n">METFACTOR</span> <span class="o">=</span> <span class="mf">58.2</span>
        <span class="n">SBC</span> <span class="o">=</span> <span class="mf">0.000000056697</span>  <span class="c1"># Stefan-Boltzmann constant (W/m2K4)</span>
        <span class="n">CSW</span> <span class="o">=</span> <span class="mi">170</span>
        <span class="n">CDIL</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="n">CSTR</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="n">TempSkinNeutral</span> <span class="o">=</span> <span class="mf">33.7</span>  <span class="c1"># setpoint (neutral) value for Tsk</span>
        <span class="n">TempCoreNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint value for Tcr</span>
        <span class="n">TempBodyNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint for Tb (.1*TempSkinNeutral + .9*TempCoreNeutral)</span>
        <span class="n">SkinBloodFlowNeutral</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># neutral value for SkinBloodFlow</span>

        <span class="c1"># INITIAL VALUES - start of 1st experiment</span>
        <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkinNeutral</span>
        <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCoreNeutral</span>
        <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="n">SkinBloodFlowNeutral</span>
        <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">ESK</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">met</span>

        <span class="c1"># Start new experiment here (for graded experiments)</span>
        <span class="c1"># UNIT CONVERSIONS (from input variables)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="mf">101325.0</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># This variable is the pressure of the atmosphere in kPa and was taken from the psychrometrics.js file of the CBE comfort tool.</span>

        <span class="n">PressureInAtmospheres</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mf">0.009869</span>
        <span class="n">LTIME</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="n">RCL</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>
        <span class="c1"># AdjustICL(RCL, Conditions);  TH: I don&#39;t think this is used in the software</span>

        <span class="n">FACL</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># % INCREASE IN BODY SURFACE AREA DUE TO CLOTHING</span>
        <span class="n">LR</span> <span class="o">=</span> <span class="mf">2.2</span> <span class="o">/</span> <span class="n">PressureInAtmospheres</span>  <span class="c1"># Lewis Relation is 2.2 at sea level</span>
        <span class="n">RM</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>

        <span class="k">if</span> <span class="n">clo</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.38</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">)</span>
            <span class="n">ICL</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.59</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">)</span>
            <span class="n">ICL</span> <span class="o">=</span> <span class="mf">0.45</span>

        <span class="n">CHC</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">PressureInAtmospheres</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">)</span>
        <span class="n">CHCV</span> <span class="o">=</span> <span class="mf">8.600001</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">AirVelocity</span> <span class="o">*</span> <span class="n">PressureInAtmospheres</span><span class="p">),</span> <span class="mf">0.53</span><span class="p">)</span>
        <span class="n">CHC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">CHC</span><span class="p">,</span> <span class="n">CHCV</span><span class="p">)</span>

        <span class="c1"># initial estimate of Tcl</span>
        <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.7</span>
        <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
        <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
        <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
        <span class="n">TCL</span> <span class="o">=</span> <span class="n">TOP</span> <span class="o">+</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTC</span> <span class="o">*</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">))</span>

        <span class="c1"># ========================  BEGIN ITERATION</span>
        <span class="c1">#</span>
        <span class="c1"># Tcl and CHR are solved iteratively using: H(Tsk - To) = CTC(Tcl - To),</span>
        <span class="c1"># where H = 1/(Ra + Rcl) and Ra = 1/Facl*CTC</span>

        <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
        <span class="n">TIME</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">LTIME</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">TIM</span> <span class="ow">in</span> <span class="n">TIME</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TCL</span> <span class="o">-</span> <span class="n">TCL_OLD</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
                    <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">SBC</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(((</span><span class="n">TCL</span> <span class="o">+</span> <span class="n">tr</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.72</span>
                    <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
                    <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
                    <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
                    <span class="n">TCL</span> <span class="o">=</span> <span class="p">(</span><span class="n">RA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">RCL</span> <span class="o">*</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">DRY</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
            <span class="n">HFCS</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempSkin</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.28</span> <span class="o">+</span> <span class="mf">1.163</span> <span class="o">*</span> <span class="n">SkinBloodFlow</span><span class="p">)</span>
            <span class="n">ERES</span> <span class="o">=</span> <span class="mf">0.0023</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">44.0</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span>
            <span class="n">CRES</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">34.0</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
            <span class="n">SCR</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">ERES</span> <span class="o">-</span> <span class="n">CRES</span> <span class="o">-</span> <span class="n">wme</span>
            <span class="n">SSK</span> <span class="o">=</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">DRY</span> <span class="o">-</span> <span class="n">ESK</span>
            <span class="n">TCSK</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
            <span class="n">TCCR</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
            <span class="n">DTSK</span> <span class="o">=</span> <span class="p">(</span><span class="n">SSK</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCSK</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
            <span class="n">DTCR</span> <span class="o">=</span> <span class="n">SCR</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCCR</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
            <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">DTSK</span>
            <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCore</span> <span class="o">+</span> <span class="n">DTCR</span>
            <span class="n">TB</span> <span class="o">=</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">TempCore</span>
            <span class="n">SKSIG</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TempSkinNeutral</span>
            <span class="n">WARMS</span> <span class="o">=</span> <span class="p">(</span><span class="n">SKSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SKSIG</span>
            <span class="n">COLDS</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span>
            <span class="n">CRSIG</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempCoreNeutral</span><span class="p">)</span>
            <span class="n">WARMC</span> <span class="o">=</span> <span class="p">(</span><span class="n">CRSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">CRSIG</span>
            <span class="n">COLDC</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span>
            <span class="n">BDSIG</span> <span class="o">=</span> <span class="n">TB</span> <span class="o">-</span> <span class="n">TempBodyNeutral</span>
            <span class="n">WARMB</span> <span class="o">=</span> <span class="p">(</span><span class="n">BDSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">BDSIG</span>
            <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkinBloodFlowNeutral</span> <span class="o">+</span> <span class="n">CDIL</span> <span class="o">*</span> <span class="n">WARMC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">CSTR</span> <span class="o">*</span> <span class="n">COLDS</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&gt;</span> <span class="mf">90.0</span><span class="p">:</span>
                <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">90.0</span>
            <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">REGSW</span> <span class="o">=</span> <span class="n">CSW</span> <span class="o">*</span> <span class="n">WARMB</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">WARMS</span> <span class="o">/</span> <span class="mf">10.7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">REGSW</span> <span class="o">&gt;</span> <span class="mf">500.0</span><span class="p">:</span>
                <span class="n">REGSW</span> <span class="o">=</span> <span class="mf">500.0</span>
            <span class="n">ERSW</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="o">*</span> <span class="n">REGSW</span>
            <span class="n">REA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACL</span> <span class="o">*</span> <span class="n">CHC</span><span class="p">)</span>  <span class="c1"># evaporative resistance of air layer</span>
            <span class="n">RECL</span> <span class="o">=</span> <span class="n">RCL</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICL</span><span class="p">)</span>  <span class="c1"># evaporative resistance of clothing (icl=.45)</span>
            <span class="n">EMAX</span> <span class="o">=</span> <span class="p">(</span><span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">REA</span> <span class="o">+</span> <span class="n">RECL</span><span class="p">)</span>
            <span class="n">PRSW</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">/</span> <span class="n">EMAX</span>
            <span class="n">PWET</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">+</span> <span class="mf">0.94</span> <span class="o">*</span> <span class="n">PRSW</span>
            <span class="n">EDIF</span> <span class="o">=</span> <span class="n">PWET</span> <span class="o">*</span> <span class="n">EMAX</span> <span class="o">-</span> <span class="n">ERSW</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="k">if</span> <span class="n">PWET</span> <span class="o">&gt;</span> <span class="n">WCRIT</span><span class="p">:</span>
                <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span> <span class="o">/</span> <span class="mf">0.94</span>
                <span class="n">ERSW</span> <span class="o">=</span> <span class="n">PRSW</span> <span class="o">*</span> <span class="n">EMAX</span>
                <span class="n">EDIF</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">PRSW</span><span class="p">)</span> <span class="o">*</span> <span class="n">EMAX</span>
                <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="k">if</span> <span class="n">EMAX</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">EDIF</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ERSW</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">ESK</span> <span class="o">=</span> <span class="n">EMAX</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">19.4</span> <span class="o">*</span> <span class="n">COLDS</span> <span class="o">*</span> <span class="n">COLDC</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">RM</span> <span class="o">+</span> <span class="n">MSHIV</span>
            <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.0417737</span> <span class="o">+</span> <span class="mf">0.7451833</span> <span class="o">/</span> <span class="p">(</span><span class="n">SkinBloodFlow</span> <span class="o">+</span> <span class="o">.</span><span class="mi">585417</span><span class="p">)</span>

        <span class="c1"># Define new heat flow terms, coeffs, and abbreviations</span>
        <span class="n">HSK</span> <span class="o">=</span> <span class="n">DRY</span> <span class="o">+</span> <span class="n">ESK</span>  <span class="c1"># total heat loss from skin</span>
        <span class="n">RN</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">wme</span>  <span class="c1"># net metabolic heat production</span>
        <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">RN</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">METFACTOR</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ECOMF</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># from Fanger</span>
        <span class="n">EMAX</span> <span class="o">=</span> <span class="n">EMAX</span> <span class="o">*</span> <span class="n">WCRIT</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">PWET</span>
        <span class="n">PSSK</span> <span class="o">=</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span>
        <span class="c1"># Definition of ASHRAE standard environment... denoted &quot;S&quot;</span>
        <span class="n">CHRS</span> <span class="o">=</span> <span class="n">CHR</span>
        <span class="k">if</span> <span class="n">met</span> <span class="o">&lt;</span> <span class="mf">0.85</span><span class="p">:</span>
            <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">5.66</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="mf">0.85</span><span class="p">),</span> <span class="mf">0.39</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CHCS</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>

        <span class="n">CTCS</span> <span class="o">=</span> <span class="n">CHCS</span> <span class="o">+</span> <span class="n">CHRS</span>
        <span class="n">RCLOS</span> <span class="o">=</span> <span class="mf">1.52</span> <span class="o">/</span> <span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="n">wme</span> <span class="o">/</span> <span class="n">METFACTOR</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.6944</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1835</span>
        <span class="n">RCLS</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">RCLOS</span>
        <span class="n">FACLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">KCLO</span> <span class="o">*</span> <span class="n">RCLOS</span>
        <span class="n">FCLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="n">RCLOS</span><span class="p">)</span>
        <span class="n">IMS</span> <span class="o">=</span> <span class="mf">0.45</span>
        <span class="n">ICLS</span> <span class="o">=</span> <span class="n">IMS</span> <span class="o">*</span> <span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FCLS</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">-</span> <span class="n">FCLS</span> <span class="o">*</span> <span class="n">IMS</span><span class="p">)</span>
        <span class="n">RAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span><span class="p">)</span>
        <span class="n">REAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CHCS</span><span class="p">)</span>
        <span class="n">RECLS</span> <span class="o">=</span> <span class="n">RCLS</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICLS</span><span class="p">)</span>
        <span class="n">HD_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">RAS</span> <span class="o">+</span> <span class="n">RCLS</span><span class="p">)</span>
        <span class="n">HE_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">REAS</span> <span class="o">+</span> <span class="n">RECLS</span><span class="p">)</span>

        <span class="c1"># SET* (standardized humidity, clo, Pb, and CHC)</span>
        <span class="c1"># determined using Newton&#39;s iterative solution</span>
        <span class="c1"># FNERRS is defined in the GENERAL SETUP section above</span>

        <span class="n">DELTA</span> <span class="o">=</span> <span class="o">.</span><span class="mo">0001</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mf">100.0</span>
        <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">HSK</span> <span class="o">/</span> <span class="n">HD_S</span>  <span class="c1"># lower bound for SET</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mo">01</span><span class="p">:</span>
            <span class="n">ERR1</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">X_OLD</span><span class="p">)</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">X_OLD</span><span class="p">)))</span>
            <span class="n">ERR2</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="p">(</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">((</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))))</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X_OLD</span> <span class="o">-</span> <span class="n">DELTA</span> <span class="o">*</span> <span class="n">ERR1</span> <span class="o">/</span> <span class="p">(</span><span class="n">ERR2</span> <span class="o">-</span> <span class="n">ERR1</span><span class="p">)</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X_OLD</span>
            <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">X</span>

        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will return accurate values if the airspeed is above the sillAirThreshold.</span>

<span class="sd">        Args:</span>
<span class="sd">            ta, air temperature (C)</span>
<span class="sd">            tr, mean radiant temperature (C)</span>
<span class="sd">            vel, relative air velocity (m/s)</span>
<span class="sd">            rh, relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met, metabolic rate (met)</span>
<span class="sd">            clo, clothing (clo)</span>
<span class="sd">            wme, external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv : Predicted mean vote</span>
<span class="sd">            ppd : Percent predicted dissatisfied [%]</span>
<span class="sd">            taAdj: Air temperature adjusted for air speed [C]</span>
<span class="sd">            coolingEffect : Difference between the air temperature and adjusted air temperature [C]</span>
<span class="sd">            set: The Standard Effective Temperature [C] (see below)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="nb">set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPierceSET</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vel</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">:</span>
            <span class="n">pmv</span><span class="p">,</span> <span class="n">ppd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPMV</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>
            <span class="n">taAdj</span> <span class="o">=</span> <span class="n">ta</span>
            <span class="n">ce</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ce_l</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ce_r</span> <span class="o">=</span> <span class="mi">40</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># precision of ce</span>

            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">ce</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="nb">set</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPierceSET</span><span class="p">(</span><span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="n">tr</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">))</span>

            <span class="n">ce</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">ce_l</span><span class="p">,</span> <span class="n">ce_r</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ce</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">ce</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">ce_l</span><span class="p">,</span> <span class="n">ce_r</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">pmv</span><span class="p">,</span> <span class="n">ppd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPMV</span><span class="p">(</span><span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="n">tr</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>
            <span class="n">taAdj</span> <span class="o">=</span> <span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span>

        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmv</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ppd</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;taAdj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">taAdj</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ce</span>

        <span class="k">return</span> <span class="n">r</span>

    <span class="k">def</span> <span class="nf">_calculatePMVParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the input conditions through the PMV model to get pmv, ppd, and set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Clear any existing values from the memory.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If the input data has a header, put a header on the output.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Predicted Mean Vote&quot;</span><span class="p">,</span> <span class="s2">&quot;PMV&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Percentage of People Dissatisfied&quot;</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Standard Effective Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Comfortable Or Not&quot;</span><span class="p">,</span> <span class="s2">&quot;0/1&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Reason For Discomfort&quot;</span><span class="p">,</span> <span class="s2">&quot;-2(cold), -1(dry), 0(comf), 1(humid), 2(hot)&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Perceived Air Temperature With Air Speed&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Cooling Effect of air speed&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>

        <span class="c1"># calculate the pmv, ppd, and set values.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">):</span>
            <span class="n">pmvResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;taAdj&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ce&#39;</span><span class="p">])</span>

            <span class="c1"># determine whether conditions meet the comfort criteria.</span>
            <span class="n">HR</span><span class="p">,</span> <span class="n">vapPress</span><span class="p">,</span> <span class="n">satPress</span> <span class="o">=</span> <span class="n">findHumidRatio</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">HR</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">HR</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Let the class know that we don&#39;t need to re-run things unless something changes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pmv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predicted mean vote (PMV) values for the input conditions.</span>
<span class="sd">        PMV is a seven-point scale from cold (-3) to hot (+3) that was used in comfort surveys of P.O. Fanger.</span>
<span class="sd">        Each interger value of the scale indicates the following:</span>
<span class="sd">            -3 = Cold</span>
<span class="sd">            -2 = Cool</span>
<span class="sd">            -1 = Slightly Cool</span>
<span class="sd">             0 = Neutral</span>
<span class="sd">            +1 = Slightly Warm</span>
<span class="sd">            +2 = Warm</span>
<span class="sd">            +3 = Hot</span>
<span class="sd">        Exceeding +1 will result in an uncomfortably warm occupant while dropping below -1 will result in an uncomfortably cool occupant.</span>
<span class="sd">        For detailed information on the PMV scale, see P.O. Fanger&#39;s original paper:</span>
<span class="sd">        Fanger, P Ole (1970). Thermal Comfort: Analysis and applications in environmental engineering.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ppd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Percentage of people dissatisfied (PPD) values for the input conditions.</span>
<span class="sd">        Specifically, this is defined by the percent of people who would have a PMV less than -1 or greater than +1 under the conditions.</span>
<span class="sd">        Note that, with this model, the best possible PPD achievable is 5% and most standards aim to have a PPD below 10%.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standard effective temperature (SET) values for the input conditions.</span>
<span class="sd">        These temperatures describe what the given input conditions &quot;feel like&quot; in relation</span>
<span class="sd">        to a standard environment of 50% relative humidity, &lt;0.1 m/s average air speed, and mean radiant temperature</span>
<span class="sd">        equal to average air temperature, in which the total heat loss from the skin of an imaginary occupant with an activity</span>
<span class="sd">        level of 1.0 met and a clothing level of 0.6 clo is the same as that from a person in the actual environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isComfortable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integer values that show whether the input conditions are comfortable according to the assigned compfortPar.</span>
<span class="sd">        Values are one of the following:</span>
<span class="sd">            0 = uncomfortable</span>
<span class="sd">            1 = comfortable</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">discomfReason</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integer values that show the reason for discomfort according to the assigned compfortPar.</span>
<span class="sd">        Values are one of the following:</span>
<span class="sd">            -2 = too cold</span>
<span class="sd">            -1 = too dry</span>
<span class="sd">             0 = comfortable</span>
<span class="sd">             1 = too humid</span>
<span class="sd">             2 = too hot</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">taAdj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Air temperatures that have been adjusted to account for the effect of air speed [C].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coolingEffect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The temperature difference in [C] between the air temperature and the air temperature adjusted for air speed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span>

    <span class="k">def</span> <span class="nf">calcMissingPMVInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetPMV</span><span class="p">,</span> <span class="n">missingInput</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lowBound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upBound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the comfort model to return a deisred target PMV given a missingInput (out of the seven total PMV model inputs), which will be adjusted to meet this targetPMV.</span>
<span class="sd">        Returns the value(s) of the missingInput that makes the model obey the targetPMV.</span>

<span class="sd">        Args:</span>
<span class="sd">            targetPMV: The target pmv that you are trying to produce from the inputs to this pmv object.</span>
<span class="sd">            missingInput: An integer that denotes which of the 6 inputs to the PMV model you want to</span>
<span class="sd">            adjust to produce the targetPMV.  Choose from the following options:</span>
<span class="sd">                0 = airTemperature</span>
<span class="sd">                1 = radTemperature</span>
<span class="sd">                2 = windSpeed</span>
<span class="sd">                3 = relHumidity</span>
<span class="sd">                4 = metRate</span>
<span class="sd">                5 = cloValue</span>
<span class="sd">                6 = externalWork</span>
<span class="sd">            lowBound: The lowest possible value of the missingInput you are tying to find.</span>
<span class="sd">                Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">            upBound: The highest possible value of the missingInput you are tying to find.</span>
<span class="sd">                Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">            error: The acceptable error in the targetPMV. The default is set to 0.001</span>

<span class="sd">        Returns:</span>
<span class="sd">            missingVal: The value of the missingInput that will produce the targetPMV.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="n">missingVal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">):</span>

            <span class="c1"># Determine the function that should be used given the requested missingInput.</span>
            <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">)[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>

            <span class="c1"># Solve for the missing input using the function.</span>
            <span class="n">xMissing</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xMissing</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">xMissing</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

            <span class="n">missingVal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xMissing</span><span class="p">)</span>

        <span class="c1"># Set the conditions of the comfort model to have the new missingVal.</span>
        <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">missingVal</span>

        <span class="c1"># Tell the comfort model to recompute now that the new values have been set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">missingVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">missingVal</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="ladybug.comfort.pmv.PMV" class="name">class <span class="ident">PMV</span></p>
      
  
    <div class="desc"><p>PMV Comfort Object.</p>
<p>Usage:
    from ladybug.comfort.pmv import PMV</p>
<div class="codehilite"><pre><span></span># Compute PMV for a single set of values.
myPmvComf = PMV.fromIndividualValues(26, 26, 0.75, 80, 1.1, 0.5)
pmv = myPmvComf.pmv

# Compute PMV for a list of data.
airTemp = [10, 12, 15, 18, 19]
relHumid = [75, 70, 60, 50, 45]
myPmvComf = PMV(airTemp, [], [], relHumid)
pmv = myPmvComf.pmv

# Compute PMV for all hours of an EPW file.
epwFileAddress = &quot;C:/ladybug/New_York_J_F_Kennedy_IntL_Ar_NY_USA/New_York_J_F_Kennedy_IntL_Ar_NY_USA.epw&quot;
myPmvComf = PMV.fromEPWFile(epwFileAddress, 1.4, 1.0)
pmv = myPmvComf.pmv
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PMV</span><span class="p">(</span><span class="n">ComfortModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PMV Comfort Object.</span>

<span class="sd">    Usage:</span>
<span class="sd">        from ladybug.comfort.pmv import PMV</span>

<span class="sd">        # Compute PMV for a single set of values.</span>
<span class="sd">        myPmvComf = PMV.fromIndividualValues(26, 26, 0.75, 80, 1.1, 0.5)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">        # Compute PMV for a list of data.</span>
<span class="sd">        airTemp = [10, 12, 15, 18, 19]</span>
<span class="sd">        relHumid = [75, 70, 60, 50, 45]</span>
<span class="sd">        myPmvComf = PMV(airTemp, [], [], relHumid)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">        # Compute PMV for all hours of an EPW file.</span>
<span class="sd">        epwFileAddress = &quot;C:/ladybug/New_York_J_F_Kennedy_IntL_Ar_NY_USA/New_York_J_F_Kennedy_IntL_Ar_NY_USA.epw&quot;</span>
<span class="sd">        myPmvComf = PMV.fromEPWFile(epwFileAddress, 1.4, 1.0)</span>
<span class="sd">        pmv = myPmvComf.pmv</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="p">[],</span> <span class="n">windSpeed</span><span class="o">=</span><span class="p">[],</span>
                 <span class="n">relHumidity</span><span class="o">=</span><span class="p">[],</span> <span class="n">metRate</span><span class="o">=</span><span class="p">[],</span> <span class="n">cloValue</span><span class="o">=</span><span class="p">[],</span> <span class="n">externalWork</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a PMV comfort object from lists of PMV inputs.&quot;&quot;&quot;</span>
        <span class="c1"># Assign all of the input values to the PMV comfort model object.</span>
        <span class="c1"># And assign defaults if nothing has been connected.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>

        <span class="k">if</span> <span class="n">radTemperature</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">radTemperature</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span>

        <span class="k">if</span> <span class="n">windSpeed</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">windSpeed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">relHumidity</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">relHumidity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">metRate</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">metRate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cloValue</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">cloValue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">externalWork</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">externalWork</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Default variables that all comfort models have.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__headerStr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># Set default comfort parameters for the PMV model.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="mf">0.1</span>

        <span class="c1"># Set blank values for the key returns of the class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromIndividualValues</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">windSpeed</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">relHumidity</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
                             <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from individual values.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">airTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">airTemperature</span> <span class="o">=</span> <span class="mf">20.0</span>
        <span class="k">if</span> <span class="n">radTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">radTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>
        <span class="k">if</span> <span class="n">windSpeed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">windSpeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">relHumidity</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">relHumidity</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">pmvModel</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">airTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">relHumidity</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">metRate</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">cloValue</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">externalWork</span><span class="p">)])</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">pmvModel</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">pmvModel</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromEPWFile</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">epwFileAddress</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
                    <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inclHeader</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from the conditions within an EPW file.</span>

<span class="sd">        Args:</span>
<span class="sd">            metRate: A value representing the metabolic rate of the human subject in met.</span>
<span class="sd">                1 met = resting seated. If list is empty, default is set to 1 met.</span>
<span class="sd">            cloValue: A lvalue representing the clothing level of the human subject in clo.</span>
<span class="sd">                1 clo = three-piece suit. If list is empty, default is set to 1 clo.</span>
<span class="sd">            externalWork: A value representing the work done by the human subject in met.</span>
<span class="sd">                1 met = resting seated. If list is empty, default is set to 0 met.</span>
<span class="sd">            header: set to &quot;True&quot; to have a ladybug header included in the output and set to</span>
<span class="sd">                &quot;False&quot; to remove the header.  The default is set to &quot;True.&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">epwData</span> <span class="o">=</span> <span class="n">EPW</span><span class="p">(</span><span class="n">epwFileAddress</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">windSpeed</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">relativeHumidity</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="p">[</span><span class="n">metRate</span><span class="p">],</span> <span class="p">[</span><span class="n">cloValue</span><span class="p">],</span> <span class="p">[</span><span class="n">externalWork</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isReCalculationNeeded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Boolean value that indicates whether the comfort values need to be re-computed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True = re-calculation is needed before comfort values can be output.</span>
<span class="sd">            False = no re-calculation is needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isDataAligned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether the input data is aligned.</span>
<span class="sd">            True = aligned</span>
<span class="sd">            False = not aligned (run the _checkAndAlignLists function to align the data)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isHeaderIncluded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether a header will be output on the results.</span>
<span class="sd">            True = header included.</span>
<span class="sd">            False = header not included.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">singleValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boolean value that indicates whether single values or a list of values will be output.</span>
<span class="sd">            True = single values output.</span>
<span class="sd">            False = lists of values output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">airTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing dry bulb temperatures in degrees Celcius.</span>
<span class="sd">        This can be a list with a LB header on it.  If list is empty, default is set to 20 C.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span>

    <span class="nd">@airTemperature.setter</span>
    <span class="k">def</span> <span class="nf">airTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="k">else</span> <span class="n">value</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing mean radiant temperatures in degrees Celcius.</span>
<span class="sd">        This list can have a LB header on it.  If list is empty, default is set be the same as __airTemperature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span>

    <span class="nd">@radTemperature.setter</span>
    <span class="k">def</span> <span class="nf">radTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">windSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing wind speeds in m/s. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0 m/s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span>

    <span class="nd">@windSpeed.setter</span>
    <span class="k">def</span> <span class="nf">windSpeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">relHumidity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing relative humidities in %. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 50%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span>

    <span class="nd">@relHumidity.setter</span>
    <span class="k">def</span> <span class="nf">relHumidity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metRate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the metabolic rate of the human subject in met.</span>
<span class="sd">        1 met = resting seated. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 1.1 met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span>

    <span class="nd">@metRate.setter</span>
    <span class="k">def</span> <span class="nf">metRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cloValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the clothing level of the human subject in clo.</span>
<span class="sd">        1 clo = three-piece suit. This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0.85 clo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span>

    <span class="nd">@cloValue.setter</span>
    <span class="k">def</span> <span class="nf">cloValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">externalWork</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number or list of numbers representing the work done by the human subject in met.</span>
<span class="sd">        This list can have a LB header on it.</span>
<span class="sd">        If list is empty, default is set to 0 met.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span>

    <span class="nd">@externalWork.setter</span>
    <span class="k">def</span> <span class="nf">externalWork</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">PPDComfortThresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the threshold of the percentage of people dissatisfied (PPD)</span>
<span class="sd">        beyond which the conditions are not comfortable.  The default is 10%.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span>

    <span class="nd">@PPDComfortThresh.setter</span>
    <span class="k">def</span> <span class="nf">PPDComfortThresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">humidRatioUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the upper boundary of humidity ratio above which conditions are considered too</span>
<span class="sd">        humid to be comfortable.  The default is set to 0.03 kg wather/kg air.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@humidRatioUp.setter</span>
    <span class="k">def</span> <span class="nf">humidRatioUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">humidRatioLow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the lower boundary of humidity ratio below which conditions are considered too</span>
<span class="sd">        dry to be comfortable.  The default is set to 0 kg wather/kg air.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@humidRatioLow.setter</span>
    <span class="k">def</span> <span class="nf">humidRatioLow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stillAirThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A number representing the wind speed beyond which the formula for Standard Effective Temperature (SET)</span>
<span class="sd">        is used to dtermine PMV/PPD (as opposed to Fanger&#39;s original equation).</span>
<span class="sd">        The default is set to 0.1 m/s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span>

    <span class="nd">@stillAirThreshold.setter</span>
    <span class="k">def</span> <span class="nf">stillAirThreshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">setComfortPar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PPDComfortThresh</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">humidRatioUp</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">humidRatioLow</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stillAirThreshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set all of the comfort parameters of the comfort model at once.  These are:</span>
<span class="sd">            PPDComfortThresh</span>
<span class="sd">            humidRatioUp</span>
<span class="sd">            humidRatioLow</span>
<span class="sd">            stillAirThreshold</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="n">PPDComfortThresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="n">humidRatioUp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="n">humidRatioLow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="n">stillAirThreshold</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">_checkAndAlignLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks to be sure that the lists of PMV input variables are aligned and fills in defaults where possible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check each list to be sure that the contents are what we want.</span>
        <span class="n">checkData1</span><span class="p">,</span> <span class="n">airTemp</span><span class="p">,</span> <span class="n">airMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="s2">&quot;airTemperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
        <span class="n">checkData2</span><span class="p">,</span> <span class="n">radTemp</span><span class="p">,</span> <span class="n">radMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">,</span> <span class="n">airTemp</span><span class="p">,</span> <span class="s2">&quot;radTemperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
        <span class="n">checkData3</span><span class="p">,</span> <span class="n">windSpeed</span><span class="p">,</span> <span class="n">windMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;windSpeed&quot;</span><span class="p">,</span> <span class="s2">&quot;Wind Speed&quot;</span><span class="p">)</span>
        <span class="n">checkData4</span><span class="p">,</span> <span class="n">relHumid</span><span class="p">,</span> <span class="n">humidMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">,</span> <span class="p">[</span><span class="mf">50.0</span><span class="p">],</span> <span class="s2">&quot;relHumidity&quot;</span><span class="p">,</span> <span class="s2">&quot;Humidity&quot;</span><span class="p">)</span>
        <span class="n">checkData5</span><span class="p">,</span> <span class="n">metRate</span><span class="p">,</span> <span class="n">metMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">],</span> <span class="s2">&quot;metabolicRate&quot;</span><span class="p">,</span> <span class="s2">&quot;Metabolic&quot;</span><span class="p">)</span>
        <span class="n">checkData6</span><span class="p">,</span> <span class="n">cloLevel</span><span class="p">,</span> <span class="n">cloMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">],</span> <span class="s2">&quot;clothingValue&quot;</span><span class="p">,</span> <span class="s2">&quot;Clothing&quot;</span><span class="p">)</span>
        <span class="n">checkData7</span><span class="p">,</span> <span class="n">exWork</span><span class="p">,</span> <span class="n">exMultVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkInputList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;externalWork&quot;</span><span class="p">,</span> <span class="s2">&quot;Work&quot;</span><span class="p">)</span>

        <span class="c1"># Finally, for those lists of length greater than 1, check to make sure that they are all the same length.</span>
        <span class="n">checkData</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">checkData1</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData2</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData3</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData4</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData5</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData6</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">checkData7</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">or</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">listLenCheck</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">airTemp</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">radTemp</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">relHumid</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metRate</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cloLevel</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">listLenCheck</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exWork</span><span class="p">))</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">listLenCheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">listLenCheck</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">checkData</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="n">listLenCheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">airMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">airTemp</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">airTemp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">radMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">radTemp</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">radTemp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">windMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">windSpeed</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">humidMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">relHumid</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">relHumid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">metMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">metRate</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">metRate</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cloMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">cloLevel</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">cloLevel</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">exMultVal</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                        <span class="n">exWork</span> <span class="o">=</span> <span class="n">duplicate</span><span class="p">(</span><span class="n">exWork</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;If you have put in lists with multiple values, the lengths of these lists must match </span><span class="se">\n</span><span class="s1"> across the parameters or you have a single value for a given parameter to be applied to all values in the list.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">checkData</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># If everything is good, re-assign the lists of input variables and set the list alignment to true.</span>
        <span class="k">if</span> <span class="n">checkData</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># Assign all of the input values to the PMV comfort model object.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="n">airTemp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">radTemp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">windSpeed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">relHumid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">metRate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">cloLevel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">exWork</span>
            <span class="c1"># Set the alighed data value to true.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">findPPD</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            pmv: The predicted mean vote (PMV) for which you want to know the PPD.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ppd: The percentage of people dissatisfied (PPD) for the input PMV.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">findPMV</span><span class="p">(</span><span class="n">ppd</span><span class="p">,</span> <span class="n">ppdError</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ppd: The percentage of people dissatisfied (PPD) for which you want to know the possible PMV.</span>
<span class="sd">            ppdError: The acceptable error in meeting the target PPD.  The default is set to 0.001.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv: A list with the two predicted mean vote (PMV) values that produces the input PPD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ppd</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">pmvLow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
            <span class="n">pmvMid</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">pmvHi</span> <span class="o">=</span> <span class="mi">3</span>

            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">((</span><span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ppd</span><span class="p">)</span>

            <span class="c1"># Solve for the missing lower PMV value.</span>
            <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pmvLowSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="c1"># Solve for the missing higher PMV value.</span>
            <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pmvHiSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">pmvLowSolution</span><span class="p">,</span> <span class="n">pmvHiSolution</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;A ppd lower than 5</span><span class="si">% i</span><span class="s1">s not achievable with the PMV model.&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">comfPMV</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Original Fanger function to compute PMV.  Only intended for use with low air speeds (&lt;0.1 m/s).</span>

<span class="sd">        Args:</span>
<span class="sd">            ta: air temperature (C)</span>
<span class="sd">            tr: mean radiant temperature (C)</span>
<span class="sd">            vel: relative air velocity (m/s)</span>
<span class="sd">            rh: relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met: metabolic rate (met)</span>
<span class="sd">            clo: clothing (clo)</span>
<span class="sd">            wme: external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv: predicted mean vote</span>
<span class="sd">            ppd: percentage of people dissatisfied.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pa</span> <span class="o">=</span> <span class="n">rh</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">16.6536</span> <span class="o">-</span> <span class="mf">4030.183</span> <span class="o">/</span> <span class="p">(</span><span class="n">ta</span> <span class="o">+</span> <span class="mi">235</span><span class="p">))</span>

        <span class="n">icl</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># thermal insulation of the clothing in M2K/W</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># metabolic rate in W/M2</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">wme</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># external work in W/M2</span>
        <span class="n">mw</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">w</span>  <span class="c1"># internal heat production in the human body</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">icl</span> <span class="o">&lt;=</span> <span class="mf">0.078</span><span class="p">):</span>
            <span class="n">fcl</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.29</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fcl</span> <span class="o">=</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.645</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>

        <span class="c1"># heat transf. coeff. by forced convection</span>
        <span class="n">hcf</span> <span class="o">=</span> <span class="mf">12.1</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vel</span><span class="p">)</span>
        <span class="n">taa</span> <span class="o">=</span> <span class="n">ta</span> <span class="o">+</span> <span class="mi">273</span>
        <span class="n">tra</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">+</span> <span class="mi">273</span>
        <span class="n">tcla</span> <span class="o">=</span> <span class="n">taa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">35.5</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.5</span> <span class="o">*</span> <span class="n">icl</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="n">p1</span> <span class="o">=</span> <span class="n">icl</span> <span class="o">*</span> <span class="n">fcl</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">3.96</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">p4</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">taa</span>
        <span class="n">p5</span> <span class="o">=</span> <span class="p">(</span><span class="mf">308.7</span> <span class="o">-</span> <span class="mf">0.028</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">50</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.00015</span>

        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xn</span> <span class="o">-</span> <span class="n">xf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="n">xf</span> <span class="o">=</span> <span class="p">(</span><span class="n">xf</span> <span class="o">+</span> <span class="n">xn</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">hcn</span> <span class="o">=</span> <span class="mf">2.38</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">xf</span> <span class="o">-</span> <span class="n">taa</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">hcf</span> <span class="o">&gt;</span> <span class="n">hcn</span><span class="p">):</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="n">hcf</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">hc</span> <span class="o">=</span> <span class="n">hcn</span>
            <span class="n">xn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p5</span> <span class="o">+</span> <span class="n">p4</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">-</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">*</span> <span class="n">hc</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">):</span>
                <span class="k">print</span> <span class="s1">&#39;Max iterations exceeded&#39;</span>
                <span class="k">return</span> <span class="mi">1</span>

        <span class="n">tcl</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">xn</span> <span class="o">-</span> <span class="mi">273</span>

        <span class="c1"># heat loss diff. through skin</span>
        <span class="n">hl1</span> <span class="o">=</span> <span class="mf">3.05</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5733</span> <span class="o">-</span> <span class="p">(</span><span class="mf">6.99</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
        <span class="c1"># heat loss by sweating</span>
        <span class="k">if</span> <span class="n">mw</span> <span class="o">&gt;</span> <span class="mf">58.15</span><span class="p">:</span>
            <span class="n">hl2</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="mf">58.15</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hl2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># latent respiration heat loss</span>
        <span class="n">hl3</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="o">*</span> <span class="mf">0.00001</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5867</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
        <span class="c1"># dry respiration heat loss</span>
        <span class="n">hl4</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">34</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
        <span class="c1"># heat loss by radiation</span>
        <span class="n">hl5</span> <span class="o">=</span> <span class="mf">3.96</span> <span class="o">*</span> <span class="n">fcl</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xn</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="c1"># heat loss by convection</span>
        <span class="n">hl6</span> <span class="o">=</span> <span class="n">fcl</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcl</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>

        <span class="n">ts</span> <span class="o">=</span> <span class="mf">0.303</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.036</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.028</span>
        <span class="n">pmv</span> <span class="o">=</span> <span class="n">ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="n">hl1</span> <span class="o">-</span> <span class="n">hl2</span> <span class="o">-</span> <span class="n">hl3</span> <span class="o">-</span> <span class="n">hl4</span> <span class="o">-</span> <span class="n">hl5</span> <span class="o">-</span> <span class="n">hl6</span><span class="p">)</span>
        <span class="n">ppd</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

        <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmv</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ppd</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">comfPierceSET</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            ta, air temperature (C)</span>
<span class="sd">            tr, mean radiant temperature (C)</span>
<span class="sd">            vel, relative air velocity (m/s)</span>
<span class="sd">            rh, relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met, metabolic rate (met)</span>
<span class="sd">            clo, clothing (clo)</span>
<span class="sd">            wme, external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            set, standard effective temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Key initial variables.</span>
        <span class="n">VaporPressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">rh</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">ta</span><span class="p">))</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="n">AirVelocity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vel</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">KCLO</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">BODYWEIGHT</span> <span class="o">=</span> <span class="mf">69.9</span>
        <span class="n">BODYSURFACEAREA</span> <span class="o">=</span> <span class="mf">1.8258</span>
        <span class="n">METFACTOR</span> <span class="o">=</span> <span class="mf">58.2</span>
        <span class="n">SBC</span> <span class="o">=</span> <span class="mf">0.000000056697</span>  <span class="c1"># Stefan-Boltzmann constant (W/m2K4)</span>
        <span class="n">CSW</span> <span class="o">=</span> <span class="mi">170</span>
        <span class="n">CDIL</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="n">CSTR</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="n">TempSkinNeutral</span> <span class="o">=</span> <span class="mf">33.7</span>  <span class="c1"># setpoint (neutral) value for Tsk</span>
        <span class="n">TempCoreNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint value for Tcr</span>
        <span class="n">TempBodyNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint for Tb (.1*TempSkinNeutral + .9*TempCoreNeutral)</span>
        <span class="n">SkinBloodFlowNeutral</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># neutral value for SkinBloodFlow</span>

        <span class="c1"># INITIAL VALUES - start of 1st experiment</span>
        <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkinNeutral</span>
        <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCoreNeutral</span>
        <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="n">SkinBloodFlowNeutral</span>
        <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">ESK</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">met</span>

        <span class="c1"># Start new experiment here (for graded experiments)</span>
        <span class="c1"># UNIT CONVERSIONS (from input variables)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="mf">101325.0</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># This variable is the pressure of the atmosphere in kPa and was taken from the psychrometrics.js file of the CBE comfort tool.</span>

        <span class="n">PressureInAtmospheres</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mf">0.009869</span>
        <span class="n">LTIME</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="n">RCL</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>
        <span class="c1"># AdjustICL(RCL, Conditions);  TH: I don&#39;t think this is used in the software</span>

        <span class="n">FACL</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># % INCREASE IN BODY SURFACE AREA DUE TO CLOTHING</span>
        <span class="n">LR</span> <span class="o">=</span> <span class="mf">2.2</span> <span class="o">/</span> <span class="n">PressureInAtmospheres</span>  <span class="c1"># Lewis Relation is 2.2 at sea level</span>
        <span class="n">RM</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>

        <span class="k">if</span> <span class="n">clo</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.38</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">)</span>
            <span class="n">ICL</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.59</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">)</span>
            <span class="n">ICL</span> <span class="o">=</span> <span class="mf">0.45</span>

        <span class="n">CHC</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">PressureInAtmospheres</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">)</span>
        <span class="n">CHCV</span> <span class="o">=</span> <span class="mf">8.600001</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">AirVelocity</span> <span class="o">*</span> <span class="n">PressureInAtmospheres</span><span class="p">),</span> <span class="mf">0.53</span><span class="p">)</span>
        <span class="n">CHC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">CHC</span><span class="p">,</span> <span class="n">CHCV</span><span class="p">)</span>

        <span class="c1"># initial estimate of Tcl</span>
        <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.7</span>
        <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
        <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
        <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
        <span class="n">TCL</span> <span class="o">=</span> <span class="n">TOP</span> <span class="o">+</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTC</span> <span class="o">*</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">))</span>

        <span class="c1"># ========================  BEGIN ITERATION</span>
        <span class="c1">#</span>
        <span class="c1"># Tcl and CHR are solved iteratively using: H(Tsk - To) = CTC(Tcl - To),</span>
        <span class="c1"># where H = 1/(Ra + Rcl) and Ra = 1/Facl*CTC</span>

        <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
        <span class="n">TIME</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">LTIME</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">TIM</span> <span class="ow">in</span> <span class="n">TIME</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TCL</span> <span class="o">-</span> <span class="n">TCL_OLD</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                    <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
                    <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">SBC</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(((</span><span class="n">TCL</span> <span class="o">+</span> <span class="n">tr</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.72</span>
                    <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
                    <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
                    <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
                    <span class="n">TCL</span> <span class="o">=</span> <span class="p">(</span><span class="n">RA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">RCL</span> <span class="o">*</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">DRY</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
            <span class="n">HFCS</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempSkin</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.28</span> <span class="o">+</span> <span class="mf">1.163</span> <span class="o">*</span> <span class="n">SkinBloodFlow</span><span class="p">)</span>
            <span class="n">ERES</span> <span class="o">=</span> <span class="mf">0.0023</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">44.0</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span>
            <span class="n">CRES</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">34.0</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
            <span class="n">SCR</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">ERES</span> <span class="o">-</span> <span class="n">CRES</span> <span class="o">-</span> <span class="n">wme</span>
            <span class="n">SSK</span> <span class="o">=</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">DRY</span> <span class="o">-</span> <span class="n">ESK</span>
            <span class="n">TCSK</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
            <span class="n">TCCR</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
            <span class="n">DTSK</span> <span class="o">=</span> <span class="p">(</span><span class="n">SSK</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCSK</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
            <span class="n">DTCR</span> <span class="o">=</span> <span class="n">SCR</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCCR</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
            <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">DTSK</span>
            <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCore</span> <span class="o">+</span> <span class="n">DTCR</span>
            <span class="n">TB</span> <span class="o">=</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">TempCore</span>
            <span class="n">SKSIG</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TempSkinNeutral</span>
            <span class="n">WARMS</span> <span class="o">=</span> <span class="p">(</span><span class="n">SKSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SKSIG</span>
            <span class="n">COLDS</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span>
            <span class="n">CRSIG</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempCoreNeutral</span><span class="p">)</span>
            <span class="n">WARMC</span> <span class="o">=</span> <span class="p">(</span><span class="n">CRSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">CRSIG</span>
            <span class="n">COLDC</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span>
            <span class="n">BDSIG</span> <span class="o">=</span> <span class="n">TB</span> <span class="o">-</span> <span class="n">TempBodyNeutral</span>
            <span class="n">WARMB</span> <span class="o">=</span> <span class="p">(</span><span class="n">BDSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">BDSIG</span>
            <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkinBloodFlowNeutral</span> <span class="o">+</span> <span class="n">CDIL</span> <span class="o">*</span> <span class="n">WARMC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">CSTR</span> <span class="o">*</span> <span class="n">COLDS</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&gt;</span> <span class="mf">90.0</span><span class="p">:</span>
                <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">90.0</span>
            <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">REGSW</span> <span class="o">=</span> <span class="n">CSW</span> <span class="o">*</span> <span class="n">WARMB</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">WARMS</span> <span class="o">/</span> <span class="mf">10.7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">REGSW</span> <span class="o">&gt;</span> <span class="mf">500.0</span><span class="p">:</span>
                <span class="n">REGSW</span> <span class="o">=</span> <span class="mf">500.0</span>
            <span class="n">ERSW</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="o">*</span> <span class="n">REGSW</span>
            <span class="n">REA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACL</span> <span class="o">*</span> <span class="n">CHC</span><span class="p">)</span>  <span class="c1"># evaporative resistance of air layer</span>
            <span class="n">RECL</span> <span class="o">=</span> <span class="n">RCL</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICL</span><span class="p">)</span>  <span class="c1"># evaporative resistance of clothing (icl=.45)</span>
            <span class="n">EMAX</span> <span class="o">=</span> <span class="p">(</span><span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">REA</span> <span class="o">+</span> <span class="n">RECL</span><span class="p">)</span>
            <span class="n">PRSW</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">/</span> <span class="n">EMAX</span>
            <span class="n">PWET</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">+</span> <span class="mf">0.94</span> <span class="o">*</span> <span class="n">PRSW</span>
            <span class="n">EDIF</span> <span class="o">=</span> <span class="n">PWET</span> <span class="o">*</span> <span class="n">EMAX</span> <span class="o">-</span> <span class="n">ERSW</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="k">if</span> <span class="n">PWET</span> <span class="o">&gt;</span> <span class="n">WCRIT</span><span class="p">:</span>
                <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span> <span class="o">/</span> <span class="mf">0.94</span>
                <span class="n">ERSW</span> <span class="o">=</span> <span class="n">PRSW</span> <span class="o">*</span> <span class="n">EMAX</span>
                <span class="n">EDIF</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">PRSW</span><span class="p">)</span> <span class="o">*</span> <span class="n">EMAX</span>
                <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="k">if</span> <span class="n">EMAX</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">EDIF</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">ERSW</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span>
                <span class="n">ESK</span> <span class="o">=</span> <span class="n">EMAX</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
            <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">19.4</span> <span class="o">*</span> <span class="n">COLDS</span> <span class="o">*</span> <span class="n">COLDC</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">RM</span> <span class="o">+</span> <span class="n">MSHIV</span>
            <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.0417737</span> <span class="o">+</span> <span class="mf">0.7451833</span> <span class="o">/</span> <span class="p">(</span><span class="n">SkinBloodFlow</span> <span class="o">+</span> <span class="o">.</span><span class="mi">585417</span><span class="p">)</span>

        <span class="c1"># Define new heat flow terms, coeffs, and abbreviations</span>
        <span class="n">HSK</span> <span class="o">=</span> <span class="n">DRY</span> <span class="o">+</span> <span class="n">ESK</span>  <span class="c1"># total heat loss from skin</span>
        <span class="n">RN</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">wme</span>  <span class="c1"># net metabolic heat production</span>
        <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">RN</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">METFACTOR</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ECOMF</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># from Fanger</span>
        <span class="n">EMAX</span> <span class="o">=</span> <span class="n">EMAX</span> <span class="o">*</span> <span class="n">WCRIT</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">PWET</span>
        <span class="n">PSSK</span> <span class="o">=</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span>
        <span class="c1"># Definition of ASHRAE standard environment... denoted &quot;S&quot;</span>
        <span class="n">CHRS</span> <span class="o">=</span> <span class="n">CHR</span>
        <span class="k">if</span> <span class="n">met</span> <span class="o">&lt;</span> <span class="mf">0.85</span><span class="p">:</span>
            <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">5.66</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="mf">0.85</span><span class="p">),</span> <span class="mf">0.39</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">CHCS</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
                <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>

        <span class="n">CTCS</span> <span class="o">=</span> <span class="n">CHCS</span> <span class="o">+</span> <span class="n">CHRS</span>
        <span class="n">RCLOS</span> <span class="o">=</span> <span class="mf">1.52</span> <span class="o">/</span> <span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="n">wme</span> <span class="o">/</span> <span class="n">METFACTOR</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.6944</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1835</span>
        <span class="n">RCLS</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">RCLOS</span>
        <span class="n">FACLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">KCLO</span> <span class="o">*</span> <span class="n">RCLOS</span>
        <span class="n">FCLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="n">RCLOS</span><span class="p">)</span>
        <span class="n">IMS</span> <span class="o">=</span> <span class="mf">0.45</span>
        <span class="n">ICLS</span> <span class="o">=</span> <span class="n">IMS</span> <span class="o">*</span> <span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FCLS</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">-</span> <span class="n">FCLS</span> <span class="o">*</span> <span class="n">IMS</span><span class="p">)</span>
        <span class="n">RAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span><span class="p">)</span>
        <span class="n">REAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CHCS</span><span class="p">)</span>
        <span class="n">RECLS</span> <span class="o">=</span> <span class="n">RCLS</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICLS</span><span class="p">)</span>
        <span class="n">HD_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">RAS</span> <span class="o">+</span> <span class="n">RCLS</span><span class="p">)</span>
        <span class="n">HE_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">REAS</span> <span class="o">+</span> <span class="n">RECLS</span><span class="p">)</span>

        <span class="c1"># SET* (standardized humidity, clo, Pb, and CHC)</span>
        <span class="c1"># determined using Newton&#39;s iterative solution</span>
        <span class="c1"># FNERRS is defined in the GENERAL SETUP section above</span>

        <span class="n">DELTA</span> <span class="o">=</span> <span class="o">.</span><span class="mo">0001</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mf">100.0</span>
        <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">HSK</span> <span class="o">/</span> <span class="n">HD_S</span>  <span class="c1"># lower bound for SET</span>
        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mo">01</span><span class="p">:</span>
            <span class="n">ERR1</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">X_OLD</span><span class="p">)</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">X_OLD</span><span class="p">)))</span>
            <span class="n">ERR2</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="p">(</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">((</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))))</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X_OLD</span> <span class="o">-</span> <span class="n">DELTA</span> <span class="o">*</span> <span class="n">ERR1</span> <span class="o">/</span> <span class="p">(</span><span class="n">ERR2</span> <span class="o">-</span> <span class="n">ERR1</span><span class="p">)</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X_OLD</span>
            <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">X</span>

        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will return accurate values if the airspeed is above the sillAirThreshold.</span>

<span class="sd">        Args:</span>
<span class="sd">            ta, air temperature (C)</span>
<span class="sd">            tr, mean radiant temperature (C)</span>
<span class="sd">            vel, relative air velocity (m/s)</span>
<span class="sd">            rh, relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">            met, metabolic rate (met)</span>
<span class="sd">            clo, clothing (clo)</span>
<span class="sd">            wme, external work, normally around 0 (met)</span>

<span class="sd">        Returns:</span>
<span class="sd">            pmv : Predicted mean vote</span>
<span class="sd">            ppd : Percent predicted dissatisfied [%]</span>
<span class="sd">            taAdj: Air temperature adjusted for air speed [C]</span>
<span class="sd">            coolingEffect : Difference between the air temperature and adjusted air temperature [C]</span>
<span class="sd">            set: The Standard Effective Temperature [C] (see below)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="nb">set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPierceSET</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">vel</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">:</span>
            <span class="n">pmv</span><span class="p">,</span> <span class="n">ppd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPMV</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>
            <span class="n">taAdj</span> <span class="o">=</span> <span class="n">ta</span>
            <span class="n">ce</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ce_l</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ce_r</span> <span class="o">=</span> <span class="mi">40</span>
            <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># precision of ce</span>

            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">ce</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="nb">set</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPierceSET</span><span class="p">(</span><span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="n">tr</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">))</span>

            <span class="n">ce</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">ce_l</span><span class="p">,</span> <span class="n">ce_r</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ce</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">ce</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">ce_l</span><span class="p">,</span> <span class="n">ce_r</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">pmv</span><span class="p">,</span> <span class="n">ppd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comfPMV</span><span class="p">(</span><span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="n">tr</span> <span class="o">-</span> <span class="n">ce</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">)</span>
            <span class="n">taAdj</span> <span class="o">=</span> <span class="n">ta</span> <span class="o">-</span> <span class="n">ce</span>

        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pmv</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ppd</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;taAdj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">taAdj</span>
        <span class="n">r</span><span class="p">[</span><span class="s1">&#39;ce&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ce</span>

        <span class="k">return</span> <span class="n">r</span>

    <span class="k">def</span> <span class="nf">_calculatePMVParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the input conditions through the PMV model to get pmv, ppd, and set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Clear any existing values from the memory.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If the input data has a header, put a header on the output.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Predicted Mean Vote&quot;</span><span class="p">,</span> <span class="s2">&quot;PMV&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Percentage of People Dissatisfied&quot;</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Standard Effective Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Comfortable Or Not&quot;</span><span class="p">,</span> <span class="s2">&quot;0/1&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Reason For Discomfort&quot;</span><span class="p">,</span> <span class="s2">&quot;-2(cold), -1(dry), 0(comf), 1(humid), 2(hot)&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Perceived Air Temperature With Air Speed&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buildCustomHeader</span><span class="p">(</span><span class="s2">&quot;Cooling Effect of air speed&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>

        <span class="c1"># calculate the pmv, ppd, and set values.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">):</span>
            <span class="n">pmvResult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;set&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;taAdj&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ce&#39;</span><span class="p">])</span>

            <span class="c1"># determine whether conditions meet the comfort criteria.</span>
            <span class="n">HR</span><span class="p">,</span> <span class="n">vapPress</span><span class="p">,</span> <span class="n">satPress</span> <span class="o">=</span> <span class="n">findHumidRatio</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;ppd&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pmvResult</span><span class="p">[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">HR</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">HR</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Let the class know that we don&#39;t need to re-run things unless something changes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pmv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predicted mean vote (PMV) values for the input conditions.</span>
<span class="sd">        PMV is a seven-point scale from cold (-3) to hot (+3) that was used in comfort surveys of P.O. Fanger.</span>
<span class="sd">        Each interger value of the scale indicates the following:</span>
<span class="sd">            -3 = Cold</span>
<span class="sd">            -2 = Cool</span>
<span class="sd">            -1 = Slightly Cool</span>
<span class="sd">             0 = Neutral</span>
<span class="sd">            +1 = Slightly Warm</span>
<span class="sd">            +2 = Warm</span>
<span class="sd">            +3 = Hot</span>
<span class="sd">        Exceeding +1 will result in an uncomfortably warm occupant while dropping below -1 will result in an uncomfortably cool occupant.</span>
<span class="sd">        For detailed information on the PMV scale, see P.O. Fanger&#39;s original paper:</span>
<span class="sd">        Fanger, P Ole (1970). Thermal Comfort: Analysis and applications in environmental engineering.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ppd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Percentage of people dissatisfied (PPD) values for the input conditions.</span>
<span class="sd">        Specifically, this is defined by the percent of people who would have a PMV less than -1 or greater than +1 under the conditions.</span>
<span class="sd">        Note that, with this model, the best possible PPD achievable is 5% and most standards aim to have a PPD below 10%.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Standard effective temperature (SET) values for the input conditions.</span>
<span class="sd">        These temperatures describe what the given input conditions &quot;feel like&quot; in relation</span>
<span class="sd">        to a standard environment of 50% relative humidity, &lt;0.1 m/s average air speed, and mean radiant temperature</span>
<span class="sd">        equal to average air temperature, in which the total heat loss from the skin of an imaginary occupant with an activity</span>
<span class="sd">        level of 1.0 met and a clothing level of 0.6 clo is the same as that from a person in the actual environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__set</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">isComfortable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integer values that show whether the input conditions are comfortable according to the assigned compfortPar.</span>
<span class="sd">        Values are one of the following:</span>
<span class="sd">            0 = uncomfortable</span>
<span class="sd">            1 = comfortable</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">discomfReason</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integer values that show the reason for discomfort according to the assigned compfortPar.</span>
<span class="sd">        Values are one of the following:</span>
<span class="sd">            -2 = too cold</span>
<span class="sd">            -1 = too dry</span>
<span class="sd">             0 = comfortable</span>
<span class="sd">             1 = too humid</span>
<span class="sd">             2 = too hot</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">taAdj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Air temperatures that have been adjusted to account for the effect of air speed [C].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coolingEffect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The temperature difference in [C] between the air temperature and the air temperature adjusted for air speed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calculatePMVParams</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span>

    <span class="k">def</span> <span class="nf">calcMissingPMVInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetPMV</span><span class="p">,</span> <span class="n">missingInput</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lowBound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upBound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the comfort model to return a deisred target PMV given a missingInput (out of the seven total PMV model inputs), which will be adjusted to meet this targetPMV.</span>
<span class="sd">        Returns the value(s) of the missingInput that makes the model obey the targetPMV.</span>

<span class="sd">        Args:</span>
<span class="sd">            targetPMV: The target pmv that you are trying to produce from the inputs to this pmv object.</span>
<span class="sd">            missingInput: An integer that denotes which of the 6 inputs to the PMV model you want to</span>
<span class="sd">            adjust to produce the targetPMV.  Choose from the following options:</span>
<span class="sd">                0 = airTemperature</span>
<span class="sd">                1 = radTemperature</span>
<span class="sd">                2 = windSpeed</span>
<span class="sd">                3 = relHumidity</span>
<span class="sd">                4 = metRate</span>
<span class="sd">                5 = cloValue</span>
<span class="sd">                6 = externalWork</span>
<span class="sd">            lowBound: The lowest possible value of the missingInput you are tying to find.</span>
<span class="sd">                Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">            upBound: The highest possible value of the missingInput you are tying to find.</span>
<span class="sd">                Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">            error: The acceptable error in the targetPMV. The default is set to 0.001</span>

<span class="sd">        Returns:</span>
<span class="sd">            missingVal: The value of the missingInput that will produce the targetPMV.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>

        <span class="n">missingVal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">):</span>

            <span class="c1"># Determine the function that should be used given the requested missingInput.</span>
            <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">)[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>

            <span class="c1"># Solve for the missing input using the function.</span>
            <span class="n">xMissing</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xMissing</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
                <span class="n">xMissing</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

            <span class="n">missingVal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xMissing</span><span class="p">)</span>

        <span class="c1"># Set the conditions of the comfort model to have the new missingVal.</span>
        <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">missingVal</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">missingVal</span>

        <span class="c1"># Tell the comfort model to recompute now that the new values have been set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">missingVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">missingVal</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#ladybug.comfort.pmv.PMV">PMV</a></li>
          <li>ladybug.comfort.comfortBase.ComfortModel</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.comfPMV">
    <p>def <span class="ident">comfPMV</span>(</p><p>ta, tr, vel, rh, met, clo, wme)</p>
    </div>
    

    
  
    <div class="desc"><p>Original Fanger function to compute PMV.  Only intended for use with low air speeds (&lt;0.1 m/s).</p>
<p>Args:
    ta: air temperature (C)
    tr: mean radiant temperature (C)
    vel: relative air velocity (m/s)
    rh: relative humidity (%) Used only this way to input humidity level
    met: metabolic rate (met)
    clo: clothing (clo)
    wme: external work, normally around 0 (met)</p>
<p>Returns:
    pmv: predicted mean vote
    ppd: percentage of people dissatisfied.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.comfPMV', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.comfPMV" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">comfPMV</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Original Fanger function to compute PMV.  Only intended for use with low air speeds (&lt;0.1 m/s).</span>
<span class="sd">    Args:</span>
<span class="sd">        ta: air temperature (C)</span>
<span class="sd">        tr: mean radiant temperature (C)</span>
<span class="sd">        vel: relative air velocity (m/s)</span>
<span class="sd">        rh: relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">        met: metabolic rate (met)</span>
<span class="sd">        clo: clothing (clo)</span>
<span class="sd">        wme: external work, normally around 0 (met)</span>
<span class="sd">    Returns:</span>
<span class="sd">        pmv: predicted mean vote</span>
<span class="sd">        ppd: percentage of people dissatisfied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pa</span> <span class="o">=</span> <span class="n">rh</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">16.6536</span> <span class="o">-</span> <span class="mf">4030.183</span> <span class="o">/</span> <span class="p">(</span><span class="n">ta</span> <span class="o">+</span> <span class="mi">235</span><span class="p">))</span>
    <span class="n">icl</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># thermal insulation of the clothing in M2K/W</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># metabolic rate in W/M2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">wme</span> <span class="o">*</span> <span class="mf">58.15</span>  <span class="c1"># external work in W/M2</span>
    <span class="n">mw</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="n">w</span>  <span class="c1"># internal heat production in the human body</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">icl</span> <span class="o">&lt;=</span> <span class="mf">0.078</span><span class="p">):</span>
        <span class="n">fcl</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.29</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fcl</span> <span class="o">=</span> <span class="mf">1.05</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.645</span> <span class="o">*</span> <span class="n">icl</span><span class="p">)</span>
    <span class="c1"># heat transf. coeff. by forced convection</span>
    <span class="n">hcf</span> <span class="o">=</span> <span class="mf">12.1</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vel</span><span class="p">)</span>
    <span class="n">taa</span> <span class="o">=</span> <span class="n">ta</span> <span class="o">+</span> <span class="mi">273</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">+</span> <span class="mi">273</span>
    <span class="n">tcla</span> <span class="o">=</span> <span class="n">taa</span> <span class="o">+</span> <span class="p">(</span><span class="mf">35.5</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.5</span> <span class="o">*</span> <span class="n">icl</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">icl</span> <span class="o">*</span> <span class="n">fcl</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mf">3.96</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">p4</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">taa</span>
    <span class="n">p5</span> <span class="o">=</span> <span class="p">(</span><span class="mf">308.7</span> <span class="o">-</span> <span class="mf">0.028</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">xn</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">xf</span> <span class="o">=</span> <span class="n">tcla</span> <span class="o">/</span> <span class="mi">50</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="mf">0.00015</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xn</span> <span class="o">-</span> <span class="n">xf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eps</span><span class="p">:</span>
        <span class="n">xf</span> <span class="o">=</span> <span class="p">(</span><span class="n">xf</span> <span class="o">+</span> <span class="n">xn</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">hcn</span> <span class="o">=</span> <span class="mf">2.38</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="n">xf</span> <span class="o">-</span> <span class="n">taa</span><span class="p">),</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">hcf</span> <span class="o">&gt;</span> <span class="n">hcn</span><span class="p">):</span>
            <span class="n">hc</span> <span class="o">=</span> <span class="n">hcf</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hc</span> <span class="o">=</span> <span class="n">hcn</span>
        <span class="n">xn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p5</span> <span class="o">+</span> <span class="n">p4</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">-</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">*</span> <span class="n">hc</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">):</span>
            <span class="k">print</span> <span class="s1">&#39;Max iterations exceeded&#39;</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="n">tcl</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">xn</span> <span class="o">-</span> <span class="mi">273</span>
    <span class="c1"># heat loss diff. through skin</span>
    <span class="n">hl1</span> <span class="o">=</span> <span class="mf">3.05</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5733</span> <span class="o">-</span> <span class="p">(</span><span class="mf">6.99</span> <span class="o">*</span> <span class="n">mw</span><span class="p">)</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
    <span class="c1"># heat loss by sweating</span>
    <span class="k">if</span> <span class="n">mw</span> <span class="o">&gt;</span> <span class="mf">58.15</span><span class="p">:</span>
        <span class="n">hl2</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="mf">58.15</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hl2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># latent respiration heat loss</span>
    <span class="n">hl3</span> <span class="o">=</span> <span class="mf">1.7</span> <span class="o">*</span> <span class="mf">0.00001</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5867</span> <span class="o">-</span> <span class="n">pa</span><span class="p">)</span>
    <span class="c1"># dry respiration heat loss</span>
    <span class="n">hl4</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="mi">34</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
    <span class="c1"># heat loss by radiation</span>
    <span class="n">hl5</span> <span class="o">=</span> <span class="mf">3.96</span> <span class="o">*</span> <span class="n">fcl</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">xn</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">tra</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># heat loss by convection</span>
    <span class="n">hl6</span> <span class="o">=</span> <span class="n">fcl</span> <span class="o">*</span> <span class="n">hc</span> <span class="o">*</span> <span class="p">(</span><span class="n">tcl</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="mf">0.303</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.036</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.028</span>
    <span class="n">pmv</span> <span class="o">=</span> <span class="n">ts</span> <span class="o">*</span> <span class="p">(</span><span class="n">mw</span> <span class="o">-</span> <span class="n">hl1</span> <span class="o">-</span> <span class="n">hl2</span> <span class="o">-</span> <span class="n">hl3</span> <span class="o">-</span> <span class="n">hl4</span> <span class="o">-</span> <span class="n">hl5</span> <span class="o">-</span> <span class="n">hl6</span><span class="p">)</span>
    <span class="n">ppd</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmv</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ppd</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.comfPierceSET">
    <p>def <span class="ident">comfPierceSET</span>(</p><p>ta, tr, vel, rh, met, clo, wme)</p>
    </div>
    

    
  
    <div class="desc"><p>Args:
    ta, air temperature (C)
    tr, mean radiant temperature (C)
    vel, relative air velocity (m/s)
    rh, relative humidity (%) Used only this way to input humidity level
    met, metabolic rate (met)
    clo, clothing (clo)
    wme, external work, normally around 0 (met)</p>
<p>Returns:
    set, standard effective temperature</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.comfPierceSET', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.comfPierceSET" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">comfPierceSET</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">vel</span><span class="p">,</span> <span class="n">rh</span><span class="p">,</span> <span class="n">met</span><span class="p">,</span> <span class="n">clo</span><span class="p">,</span> <span class="n">wme</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        ta, air temperature (C)</span>
<span class="sd">        tr, mean radiant temperature (C)</span>
<span class="sd">        vel, relative air velocity (m/s)</span>
<span class="sd">        rh, relative humidity (%) Used only this way to input humidity level</span>
<span class="sd">        met, metabolic rate (met)</span>
<span class="sd">        clo, clothing (clo)</span>
<span class="sd">        wme, external work, normally around 0 (met)</span>
<span class="sd">    Returns:</span>
<span class="sd">        set, standard effective temperature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Key initial variables.</span>
    <span class="n">VaporPressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">rh</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">ta</span><span class="p">))</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">AirVelocity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vel</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">KCLO</span> <span class="o">=</span> <span class="mf">0.25</span>
    <span class="n">BODYWEIGHT</span> <span class="o">=</span> <span class="mf">69.9</span>
    <span class="n">BODYSURFACEAREA</span> <span class="o">=</span> <span class="mf">1.8258</span>
    <span class="n">METFACTOR</span> <span class="o">=</span> <span class="mf">58.2</span>
    <span class="n">SBC</span> <span class="o">=</span> <span class="mf">0.000000056697</span>  <span class="c1"># Stefan-Boltzmann constant (W/m2K4)</span>
    <span class="n">CSW</span> <span class="o">=</span> <span class="mi">170</span>
    <span class="n">CDIL</span> <span class="o">=</span> <span class="mi">120</span>
    <span class="n">CSTR</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">TempSkinNeutral</span> <span class="o">=</span> <span class="mf">33.7</span>  <span class="c1"># setpoint (neutral) value for Tsk</span>
    <span class="n">TempCoreNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint value for Tcr</span>
    <span class="n">TempBodyNeutral</span> <span class="o">=</span> <span class="mf">36.49</span>  <span class="c1"># setpoint for Tb (.1*TempSkinNeutral + .9*TempCoreNeutral)</span>
    <span class="n">SkinBloodFlowNeutral</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># neutral value for SkinBloodFlow</span>
    <span class="c1"># INITIAL VALUES - start of 1st experiment</span>
    <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkinNeutral</span>
    <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCoreNeutral</span>
    <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="n">SkinBloodFlowNeutral</span>
    <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">ESK</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">met</span>
    <span class="c1"># Start new experiment here (for graded experiments)</span>
    <span class="c1"># UNIT CONVERSIONS (from input variables)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">101325.0</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># This variable is the pressure of the atmosphere in kPa and was taken from the psychrometrics.js file of the CBE comfort tool.</span>
    <span class="n">PressureInAtmospheres</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="mf">0.009869</span>
    <span class="n">LTIME</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">RCL</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">clo</span>
    <span class="c1"># AdjustICL(RCL, Conditions);  TH: I don&#39;t think this is used in the software</span>
    <span class="n">FACL</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">clo</span>  <span class="c1"># % INCREASE IN BODY SURFACE AREA DUE TO CLOTHING</span>
    <span class="n">LR</span> <span class="o">=</span> <span class="mf">2.2</span> <span class="o">/</span> <span class="n">PressureInAtmospheres</span>  <span class="c1"># Lewis Relation is 2.2 at sea level</span>
    <span class="n">RM</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">met</span> <span class="o">*</span> <span class="n">METFACTOR</span>
    <span class="k">if</span> <span class="n">clo</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.38</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">)</span>
        <span class="n">ICL</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">WCRIT</span> <span class="o">=</span> <span class="mf">0.59</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">AirVelocity</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08</span><span class="p">)</span>
        <span class="n">ICL</span> <span class="o">=</span> <span class="mf">0.45</span>
    <span class="n">CHC</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">PressureInAtmospheres</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">)</span>
    <span class="n">CHCV</span> <span class="o">=</span> <span class="mf">8.600001</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">AirVelocity</span> <span class="o">*</span> <span class="n">PressureInAtmospheres</span><span class="p">),</span> <span class="mf">0.53</span><span class="p">)</span>
    <span class="n">CHC</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">CHC</span><span class="p">,</span> <span class="n">CHCV</span><span class="p">)</span>
    <span class="c1"># initial estimate of Tcl</span>
    <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.7</span>
    <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
    <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
    <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
    <span class="n">TCL</span> <span class="o">=</span> <span class="n">TOP</span> <span class="o">+</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CTC</span> <span class="o">*</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">))</span>
    <span class="c1"># ========================  BEGIN ITERATION</span>
    <span class="c1">#</span>
    <span class="c1"># Tcl and CHR are solved iteratively using: H(Tsk - To) = CTC(Tcl - To),</span>
    <span class="c1"># where H = 1/(Ra + Rcl) and Ra = 1/Facl*CTC</span>
    <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
    <span class="n">TIME</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">LTIME</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">TIM</span> <span class="ow">in</span> <span class="n">TIME</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TCL</span> <span class="o">-</span> <span class="n">TCL_OLD</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="n">TCL_OLD</span> <span class="o">=</span> <span class="n">TCL</span>
                <span class="n">CHR</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">SBC</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(((</span><span class="n">TCL</span> <span class="o">+</span> <span class="n">tr</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">),</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.72</span>
                <span class="n">CTC</span> <span class="o">=</span> <span class="n">CHR</span> <span class="o">+</span> <span class="n">CHC</span>
                <span class="n">RA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACL</span> <span class="o">*</span> <span class="n">CTC</span><span class="p">)</span>  <span class="c1"># resistance of air layer to dry heat transfer</span>
                <span class="n">TOP</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHR</span> <span class="o">*</span> <span class="n">tr</span> <span class="o">+</span> <span class="n">CHC</span> <span class="o">*</span> <span class="n">ta</span><span class="p">)</span> <span class="o">/</span> <span class="n">CTC</span>
                <span class="n">TCL</span> <span class="o">=</span> <span class="p">(</span><span class="n">RA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">RCL</span> <span class="o">*</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">DRY</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TOP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">RA</span> <span class="o">+</span> <span class="n">RCL</span><span class="p">)</span>
        <span class="n">HFCS</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempSkin</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.28</span> <span class="o">+</span> <span class="mf">1.163</span> <span class="o">*</span> <span class="n">SkinBloodFlow</span><span class="p">)</span>
        <span class="n">ERES</span> <span class="o">=</span> <span class="mf">0.0023</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">44.0</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span>
        <span class="n">CRES</span> <span class="o">=</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mf">34.0</span> <span class="o">-</span> <span class="n">ta</span><span class="p">)</span>
        <span class="n">SCR</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">ERES</span> <span class="o">-</span> <span class="n">CRES</span> <span class="o">-</span> <span class="n">wme</span>
        <span class="n">SSK</span> <span class="o">=</span> <span class="n">HFCS</span> <span class="o">-</span> <span class="n">DRY</span> <span class="o">-</span> <span class="n">ESK</span>
        <span class="n">TCSK</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
        <span class="n">TCCR</span> <span class="o">=</span> <span class="mf">0.97</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">BODYWEIGHT</span>
        <span class="n">DTSK</span> <span class="o">=</span> <span class="p">(</span><span class="n">SSK</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCSK</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
        <span class="n">DTCR</span> <span class="o">=</span> <span class="n">SCR</span> <span class="o">*</span> <span class="n">BODYSURFACEAREA</span> <span class="o">/</span> <span class="p">(</span><span class="n">TCCR</span> <span class="o">*</span> <span class="mf">60.0</span><span class="p">)</span>  <span class="c1"># deg C per minute</span>
        <span class="n">TempSkin</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="n">DTSK</span>
        <span class="n">TempCore</span> <span class="o">=</span> <span class="n">TempCore</span> <span class="o">+</span> <span class="n">DTCR</span>
        <span class="n">TB</span> <span class="o">=</span> <span class="n">ALFA</span> <span class="o">*</span> <span class="n">TempSkin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ALFA</span><span class="p">)</span> <span class="o">*</span> <span class="n">TempCore</span>
        <span class="n">SKSIG</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">TempSkinNeutral</span>
        <span class="n">WARMS</span> <span class="o">=</span> <span class="p">(</span><span class="n">SKSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">SKSIG</span>
        <span class="n">COLDS</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">SKSIG</span><span class="p">)</span>
        <span class="n">CRSIG</span> <span class="o">=</span> <span class="p">(</span><span class="n">TempCore</span> <span class="o">-</span> <span class="n">TempCoreNeutral</span><span class="p">)</span>
        <span class="n">WARMC</span> <span class="o">=</span> <span class="p">(</span><span class="n">CRSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">CRSIG</span>
        <span class="n">COLDC</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">CRSIG</span><span class="p">)</span>
        <span class="n">BDSIG</span> <span class="o">=</span> <span class="n">TB</span> <span class="o">-</span> <span class="n">TempBodyNeutral</span>
        <span class="n">WARMB</span> <span class="o">=</span> <span class="p">(</span><span class="n">BDSIG</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">BDSIG</span>
        <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkinBloodFlowNeutral</span> <span class="o">+</span> <span class="n">CDIL</span> <span class="o">*</span> <span class="n">WARMC</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">CSTR</span> <span class="o">*</span> <span class="n">COLDS</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&gt;</span> <span class="mf">90.0</span><span class="p">:</span>
            <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">90.0</span>
        <span class="k">if</span> <span class="n">SkinBloodFlow</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">SkinBloodFlow</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">REGSW</span> <span class="o">=</span> <span class="n">CSW</span> <span class="o">*</span> <span class="n">WARMB</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">WARMS</span> <span class="o">/</span> <span class="mf">10.7</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">REGSW</span> <span class="o">&gt;</span> <span class="mf">500.0</span><span class="p">:</span>
            <span class="n">REGSW</span> <span class="o">=</span> <span class="mf">500.0</span>
        <span class="n">ERSW</span> <span class="o">=</span> <span class="mf">0.68</span> <span class="o">*</span> <span class="n">REGSW</span>
        <span class="n">REA</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACL</span> <span class="o">*</span> <span class="n">CHC</span><span class="p">)</span>  <span class="c1"># evaporative resistance of air layer</span>
        <span class="n">RECL</span> <span class="o">=</span> <span class="n">RCL</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICL</span><span class="p">)</span>  <span class="c1"># evaporative resistance of clothing (icl=.45)</span>
        <span class="n">EMAX</span> <span class="o">=</span> <span class="p">(</span><span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span> <span class="o">-</span> <span class="n">VaporPressure</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">REA</span> <span class="o">+</span> <span class="n">RECL</span><span class="p">)</span>
        <span class="n">PRSW</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">/</span> <span class="n">EMAX</span>
        <span class="n">PWET</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">+</span> <span class="mf">0.94</span> <span class="o">*</span> <span class="n">PRSW</span>
        <span class="n">EDIF</span> <span class="o">=</span> <span class="n">PWET</span> <span class="o">*</span> <span class="n">EMAX</span> <span class="o">-</span> <span class="n">ERSW</span>
        <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
        <span class="k">if</span> <span class="n">PWET</span> <span class="o">&gt;</span> <span class="n">WCRIT</span><span class="p">:</span>
            <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
            <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span> <span class="o">/</span> <span class="mf">0.94</span>
            <span class="n">ERSW</span> <span class="o">=</span> <span class="n">PRSW</span> <span class="o">*</span> <span class="n">EMAX</span>
            <span class="n">EDIF</span> <span class="o">=</span> <span class="mf">0.06</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">PRSW</span><span class="p">)</span> <span class="o">*</span> <span class="n">EMAX</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
        <span class="k">if</span> <span class="n">EMAX</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">EDIF</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ERSW</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">PWET</span> <span class="o">=</span> <span class="n">WCRIT</span>
            <span class="n">PRSW</span> <span class="o">=</span> <span class="n">WCRIT</span>
            <span class="n">ESK</span> <span class="o">=</span> <span class="n">EMAX</span>
        <span class="n">ESK</span> <span class="o">=</span> <span class="n">ERSW</span> <span class="o">+</span> <span class="n">EDIF</span>
        <span class="n">MSHIV</span> <span class="o">=</span> <span class="mf">19.4</span> <span class="o">*</span> <span class="n">COLDS</span> <span class="o">*</span> <span class="n">COLDC</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">RM</span> <span class="o">+</span> <span class="n">MSHIV</span>
        <span class="n">ALFA</span> <span class="o">=</span> <span class="mf">0.0417737</span> <span class="o">+</span> <span class="mf">0.7451833</span> <span class="o">/</span> <span class="p">(</span><span class="n">SkinBloodFlow</span> <span class="o">+</span> <span class="o">.</span><span class="mi">585417</span><span class="p">)</span>
    <span class="c1"># Define new heat flow terms, coeffs, and abbreviations</span>
    <span class="n">HSK</span> <span class="o">=</span> <span class="n">DRY</span> <span class="o">+</span> <span class="n">ESK</span>  <span class="c1"># total heat loss from skin</span>
    <span class="n">RN</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="n">wme</span>  <span class="c1"># net metabolic heat production</span>
    <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">*</span> <span class="p">(</span><span class="n">RN</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">METFACTOR</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ECOMF</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">ECOMF</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># from Fanger</span>
    <span class="n">EMAX</span> <span class="o">=</span> <span class="n">EMAX</span> <span class="o">*</span> <span class="n">WCRIT</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">PWET</span>
    <span class="n">PSSK</span> <span class="o">=</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">TempSkin</span><span class="p">)</span>
    <span class="c1"># Definition of ASHRAE standard environment... denoted &quot;S&quot;</span>
    <span class="n">CHRS</span> <span class="o">=</span> <span class="n">CHR</span>
    <span class="k">if</span> <span class="n">met</span> <span class="o">&lt;</span> <span class="mf">0.85</span><span class="p">:</span>
        <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">5.66</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="mf">0.85</span><span class="p">),</span> <span class="mf">0.39</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CHCS</span> <span class="o">&lt;</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">CHCS</span> <span class="o">=</span> <span class="mf">3.0</span>
    <span class="n">CTCS</span> <span class="o">=</span> <span class="n">CHCS</span> <span class="o">+</span> <span class="n">CHRS</span>
    <span class="n">RCLOS</span> <span class="o">=</span> <span class="mf">1.52</span> <span class="o">/</span> <span class="p">((</span><span class="n">met</span> <span class="o">-</span> <span class="n">wme</span> <span class="o">/</span> <span class="n">METFACTOR</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.6944</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.1835</span>
    <span class="n">RCLS</span> <span class="o">=</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">RCLOS</span>
    <span class="n">FACLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">KCLO</span> <span class="o">*</span> <span class="n">RCLOS</span>
    <span class="n">FCLS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.155</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="n">RCLOS</span><span class="p">)</span>
    <span class="n">IMS</span> <span class="o">=</span> <span class="mf">0.45</span>
    <span class="n">ICLS</span> <span class="o">=</span> <span class="n">IMS</span> <span class="o">*</span> <span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">FCLS</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">CHCS</span> <span class="o">/</span> <span class="n">CTCS</span> <span class="o">-</span> <span class="n">FCLS</span> <span class="o">*</span> <span class="n">IMS</span><span class="p">)</span>
    <span class="n">RAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">FACLS</span> <span class="o">*</span> <span class="n">CTCS</span><span class="p">)</span>
    <span class="n">REAS</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">FACLS</span> <span class="o">*</span> <span class="n">CHCS</span><span class="p">)</span>
    <span class="n">RECLS</span> <span class="o">=</span> <span class="n">RCLS</span> <span class="o">/</span> <span class="p">(</span><span class="n">LR</span> <span class="o">*</span> <span class="n">ICLS</span><span class="p">)</span>
    <span class="n">HD_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">RAS</span> <span class="o">+</span> <span class="n">RCLS</span><span class="p">)</span>
    <span class="n">HE_S</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">REAS</span> <span class="o">+</span> <span class="n">RECLS</span><span class="p">)</span>
    <span class="c1"># SET* (standardized humidity, clo, Pb, and CHC)</span>
    <span class="c1"># determined using Newton&#39;s iterative solution</span>
    <span class="c1"># FNERRS is defined in the GENERAL SETUP section above</span>
    <span class="n">DELTA</span> <span class="o">=</span> <span class="o">.</span><span class="mo">0001</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mf">100.0</span>
    <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">TempSkin</span> <span class="o">-</span> <span class="n">HSK</span> <span class="o">/</span> <span class="n">HD_S</span>  <span class="c1"># lower bound for SET</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mo">01</span><span class="p">:</span>
        <span class="n">ERR1</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="n">X_OLD</span><span class="p">)</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">(</span><span class="n">X_OLD</span><span class="p">)))</span>
        <span class="n">ERR2</span> <span class="o">=</span> <span class="p">(</span><span class="n">HSK</span> <span class="o">-</span> <span class="n">HD_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">TempSkin</span> <span class="o">-</span> <span class="p">(</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))</span> <span class="o">-</span> <span class="n">W</span> <span class="o">*</span> <span class="n">HE_S</span> <span class="o">*</span> <span class="p">(</span><span class="n">PSSK</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">findSaturatedVaporPressureTorr</span><span class="p">((</span><span class="n">X_OLD</span> <span class="o">+</span> <span class="n">DELTA</span><span class="p">))))</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X_OLD</span> <span class="o">-</span> <span class="n">DELTA</span> <span class="o">*</span> <span class="n">ERR1</span> <span class="o">/</span> <span class="p">(</span><span class="n">ERR2</span> <span class="o">-</span> <span class="n">ERR1</span><span class="p">)</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X_OLD</span>
        <span class="n">X_OLD</span> <span class="o">=</span> <span class="n">X</span>
    <span class="k">return</span> <span class="n">X</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.findPMV">
    <p>def <span class="ident">findPMV</span>(</p><p>ppd, ppdError=0.001)</p>
    </div>
    

    
  
    <div class="desc"><p>Args:
    ppd: The percentage of people dissatisfied (PPD) for which you want to know the possible PMV.
    ppdError: The acceptable error in meeting the target PPD.  The default is set to 0.001.</p>
<p>Returns:
    pmv: A list with the two predicted mean vote (PMV) values that produces the input PPD.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.findPMV', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.findPMV" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">findPMV</span><span class="p">(</span><span class="n">ppd</span><span class="p">,</span> <span class="n">ppdError</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        ppd: The percentage of people dissatisfied (PPD) for which you want to know the possible PMV.</span>
<span class="sd">        ppdError: The acceptable error in meeting the target PPD.  The default is set to 0.001.</span>
<span class="sd">    Returns:</span>
<span class="sd">        pmv: A list with the two predicted mean vote (PMV) values that produces the input PPD.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ppd</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">pmvLow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
        <span class="n">pmvMid</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pmvHi</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">((</span><span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ppd</span><span class="p">)</span>
        <span class="c1"># Solve for the missing lower PMV value.</span>
        <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pmvLowSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
            <span class="n">pmvLowSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvLow</span><span class="p">,</span> <span class="n">pmvMid</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
        <span class="c1"># Solve for the missing higher PMV value.</span>
        <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pmvHiSolution</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
            <span class="n">pmvHiSolution</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">pmvMid</span><span class="p">,</span> <span class="n">pmvHi</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">ppdError</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pmvLowSolution</span><span class="p">,</span> <span class="n">pmvHiSolution</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;A ppd lower than 5</span><span class="si">% i</span><span class="s1">s not achievable with the PMV model.&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.findPPD">
    <p>def <span class="ident">findPPD</span>(</p><p>pmv)</p>
    </div>
    

    
  
    <div class="desc"><p>Args:
    pmv: The predicted mean vote (PMV) for which you want to know the PPD.</p>
<p>Returns:
    ppd: The percentage of people dissatisfied (PPD) for the input PMV.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.findPPD', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.findPPD" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">findPPD</span><span class="p">(</span><span class="n">pmv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        pmv: The predicted mean vote (PMV) for which you want to know the PPD.</span>
<span class="sd">    Returns:</span>
<span class="sd">        ppd: The percentage of people dissatisfied (PPD) for the input PMV.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">100.0</span> <span class="o">-</span> <span class="mf">95.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.03353</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.2179</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">pmv</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.PPDComfortThresh" class="name">var <span class="ident">PPDComfortThresh</span></p>
            

            
  
    <div class="desc"><p>A number representing the threshold of the percentage of people dissatisfied (PPD)
beyond which the conditions are not comfortable.  The default is 10%.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.airTemperature" class="name">var <span class="ident">airTemperature</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.cloValue" class="name">var <span class="ident">cloValue</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing the clothing level of the human subject in clo.
1 clo = three-piece suit. This list can have a LB header on it.
If list is empty, default is set to 0.85 clo.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.coolingEffect" class="name">var <span class="ident">coolingEffect</span></p>
            

            
  
    <div class="desc"><p>The temperature difference in [C] between the air temperature and the air temperature adjusted for air speed.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.discomfReason" class="name">var <span class="ident">discomfReason</span></p>
            

            
  
    <div class="desc"><p>Integer values that show the reason for discomfort according to the assigned compfortPar.
Values are one of the following:
    -2 = too cold
    -1 = too dry
     0 = comfortable
     1 = too humid
     2 = too hot</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.externalWork" class="name">var <span class="ident">externalWork</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing the work done by the human subject in met.
This list can have a LB header on it.
If list is empty, default is set to 0 met.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.humidRatioLow" class="name">var <span class="ident">humidRatioLow</span></p>
            

            
  
    <div class="desc"><p>A number representing the lower boundary of humidity ratio below which conditions are considered too
dry to be comfortable.  The default is set to 0 kg wather/kg air.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.humidRatioUp" class="name">var <span class="ident">humidRatioUp</span></p>
            

            
  
    <div class="desc"><p>A number representing the upper boundary of humidity ratio above which conditions are considered too
humid to be comfortable.  The default is set to 0.03 kg wather/kg air.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.isComfortable" class="name">var <span class="ident">isComfortable</span></p>
            

            
  
    <div class="desc"><p>Integer values that show whether the input conditions are comfortable according to the assigned compfortPar.
Values are one of the following:
    0 = uncomfortable
    1 = comfortable</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.isDataAligned" class="name">var <span class="ident">isDataAligned</span></p>
            

            
  
    <div class="desc"><p>Boolean value that indicates whether the input data is aligned.
    True = aligned
    False = not aligned (run the _checkAndAlignLists function to align the data)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.isHeaderIncluded" class="name">var <span class="ident">isHeaderIncluded</span></p>
            

            
  
    <div class="desc"><p>Boolean value that indicates whether a header will be output on the results.
    True = header included.
    False = header not included.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.isReCalculationNeeded" class="name">var <span class="ident">isReCalculationNeeded</span></p>
            

            
  
    <div class="desc"><p>Boolean value that indicates whether the comfort values need to be re-computed.</p>
<p>Returns:
    True = re-calculation is needed before comfort values can be output.
    False = no re-calculation is needed.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.metRate" class="name">var <span class="ident">metRate</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing the metabolic rate of the human subject in met.
1 met = resting seated. This list can have a LB header on it.
If list is empty, default is set to 1.1 met.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.pmv" class="name">var <span class="ident">pmv</span></p>
            

            
  
    <div class="desc"><p>Predicted mean vote (PMV) values for the input conditions.
PMV is a seven-point scale from cold (-3) to hot (+3) that was used in comfort surveys of P.O. Fanger.
Each interger value of the scale indicates the following:
    -3 = Cold
    -2 = Cool
    -1 = Slightly Cool
     0 = Neutral
    +1 = Slightly Warm
    +2 = Warm
    +3 = Hot
Exceeding +1 will result in an uncomfortably warm occupant while dropping below -1 will result in an uncomfortably cool occupant.
For detailed information on the PMV scale, see P.O. Fanger's original paper:
Fanger, P Ole (1970). Thermal Comfort: Analysis and applications in environmental engineering.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.ppd" class="name">var <span class="ident">ppd</span></p>
            

            
  
    <div class="desc"><p>Percentage of people dissatisfied (PPD) values for the input conditions.
Specifically, this is defined by the percent of people who would have a PMV less than -1 or greater than +1 under the conditions.
Note that, with this model, the best possible PPD achievable is 5% and most standards aim to have a PPD below 10%.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.radTemperature" class="name">var <span class="ident">radTemperature</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing mean radiant temperatures in degrees Celcius.
This list can have a LB header on it.  If list is empty, default is set be the same as __airTemperature.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.relHumidity" class="name">var <span class="ident">relHumidity</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing relative humidities in %. This list can have a LB header on it.
If list is empty, default is set to 50%.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.set" class="name">var <span class="ident">set</span></p>
            

            
  
    <div class="desc"><p>Standard effective temperature (SET) values for the input conditions.
These temperatures describe what the given input conditions "feel like" in relation
to a standard environment of 50% relative humidity, &lt;0.1 m/s average air speed, and mean radiant temperature
equal to average air temperature, in which the total heat loss from the skin of an imaginary occupant with an activity
level of 1.0 met and a clothing level of 0.6 clo is the same as that from a person in the actual environment.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.singleValues" class="name">var <span class="ident">singleValues</span></p>
            

            
  
    <div class="desc"><p>Boolean value that indicates whether single values or a list of values will be output.
    True = single values output.
    False = lists of values output.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.stillAirThreshold" class="name">var <span class="ident">stillAirThreshold</span></p>
            

            
  
    <div class="desc"><p>A number representing the wind speed beyond which the formula for Standard Effective Temperature (SET)
is used to dtermine PMV/PPD (as opposed to Fanger's original equation).
The default is set to 0.1 m/s.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.taAdj" class="name">var <span class="ident">taAdj</span></p>
            

            
  
    <div class="desc"><p>Air temperatures that have been adjusted to account for the effect of air speed [C].</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="ladybug.comfort.pmv.PMV.windSpeed" class="name">var <span class="ident">windSpeed</span></p>
            

            
  
    <div class="desc"><p>A number or list of numbers representing wind speeds in m/s. This list can have a LB header on it.
If list is empty, default is set to 0 m/s.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, airTemperature=None, radTemperature=[], windSpeed=[], relHumidity=[], metRate=[], cloValue=[], externalWork=[])</p>
    </div>
    

    
  
    <div class="desc"><p>Initialize a PMV comfort object from lists of PMV inputs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.__init__', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="p">[],</span> <span class="n">windSpeed</span><span class="o">=</span><span class="p">[],</span>
             <span class="n">relHumidity</span><span class="o">=</span><span class="p">[],</span> <span class="n">metRate</span><span class="o">=</span><span class="p">[],</span> <span class="n">cloValue</span><span class="o">=</span><span class="p">[],</span> <span class="n">externalWork</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a PMV comfort object from lists of PMV inputs.&quot;&quot;&quot;</span>
    <span class="c1"># Assign all of the input values to the PMV comfort model object.</span>
    <span class="c1"># And assign defaults if nothing has been connected.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">airTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>
    <span class="k">if</span> <span class="n">radTemperature</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">radTemperature</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span>
    <span class="k">if</span> <span class="n">windSpeed</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">windSpeed</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">relHumidity</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">relHumidity</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">metRate</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">metRate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">cloValue</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">cloValue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">externalWork</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">externalWork</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Default variables that all comfort models have.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__headerIncl</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__headerStr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="c1"># Set default comfort parameters for the PMV model.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="mf">0.03</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="c1"># Set blank values for the key returns of the class.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__pmv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__ppd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__set</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__isComfortable</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__discomfReason</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__taAdj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__coolingEffect</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.buildCustomHeader">
    <p>def <span class="ident">buildCustomHeader</span>(</p><p>self, headerName, headerUnits)</p>
    </div>
    

    
  
    <div class="desc"><p>Builds a customized header for a certain data type given the header on the inputs.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.buildCustomHeader', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.buildCustomHeader" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">buildCustomHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headerName</span><span class="p">,</span> <span class="n">headerUnits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a customized header for a certain data type given the header on the inputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">newHeadStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__headerStr</span>
    <span class="n">newHeadStr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">headerName</span>
    <span class="n">newHeadStr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">headerUnits</span>
    <span class="k">return</span> <span class="n">newHeadStr</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.calcMissingPMVInput">
    <p>def <span class="ident">calcMissingPMVInput</span>(</p><p>self, targetPMV, missingInput=0, lowBound=0, upBound=100, error=0.001)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets the comfort model to return a deisred target PMV given a missingInput (out of the seven total PMV model inputs), which will be adjusted to meet this targetPMV.
Returns the value(s) of the missingInput that makes the model obey the targetPMV.</p>
<p>Args:
    targetPMV: The target pmv that you are trying to produce from the inputs to this pmv object.
    missingInput: An integer that denotes which of the 6 inputs to the PMV model you want to
    adjust to produce the targetPMV.  Choose from the following options:
        0 = airTemperature
        1 = radTemperature
        2 = windSpeed
        3 = relHumidity
        4 = metRate
        5 = cloValue
        6 = externalWork
    lowBound: The lowest possible value of the missingInput you are tying to find.
        Putting in a good value here will help the model converge to a solution faster.
    upBound: The highest possible value of the missingInput you are tying to find.
        Putting in a good value here will help the model converge to a solution faster.
    error: The acceptable error in the targetPMV. The default is set to 0.001</p>
<p>Returns:
    missingVal: The value of the missingInput that will produce the targetPMV.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.calcMissingPMVInput', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.calcMissingPMVInput" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calcMissingPMVInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetPMV</span><span class="p">,</span> <span class="n">missingInput</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lowBound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upBound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the comfort model to return a deisred target PMV given a missingInput (out of the seven total PMV model inputs), which will be adjusted to meet this targetPMV.</span>
<span class="sd">    Returns the value(s) of the missingInput that makes the model obey the targetPMV.</span>
<span class="sd">    Args:</span>
<span class="sd">        targetPMV: The target pmv that you are trying to produce from the inputs to this pmv object.</span>
<span class="sd">        missingInput: An integer that denotes which of the 6 inputs to the PMV model you want to</span>
<span class="sd">        adjust to produce the targetPMV.  Choose from the following options:</span>
<span class="sd">            0 = airTemperature</span>
<span class="sd">            1 = radTemperature</span>
<span class="sd">            2 = windSpeed</span>
<span class="sd">            3 = relHumidity</span>
<span class="sd">            4 = metRate</span>
<span class="sd">            5 = cloValue</span>
<span class="sd">            6 = externalWork</span>
<span class="sd">        lowBound: The lowest possible value of the missingInput you are tying to find.</span>
<span class="sd">            Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">        upBound: The highest possible value of the missingInput you are tying to find.</span>
<span class="sd">            Putting in a good value here will help the model converge to a solution faster.</span>
<span class="sd">        error: The acceptable error in the targetPMV. The default is set to 0.001</span>
<span class="sd">    Returns:</span>
<span class="sd">        missingVal: The value of the missingInput that will produce the targetPMV.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__isDataAligned</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkAndAlignLists</span><span class="p">()</span>
    <span class="n">missingVal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__calcLength</span><span class="p">):</span>
        <span class="c1"># Determine the function that should be used given the requested missingInput.</span>
        <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comfPMVElevatedAirspeed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">)[</span><span class="s1">&#39;pmv&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">targetPMV</span><span class="p">)</span>
        <span class="c1"># Solve for the missing input using the function.</span>
        <span class="n">xMissing</span> <span class="o">=</span> <span class="n">secant</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xMissing</span> <span class="o">==</span> <span class="s1">&#39;NaN&#39;</span><span class="p">:</span>
            <span class="n">xMissing</span> <span class="o">=</span> <span class="n">bisect</span><span class="p">(</span><span class="n">lowBound</span><span class="p">,</span> <span class="n">upBound</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="n">missingVal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xMissing</span><span class="p">)</span>
    <span class="c1"># Set the conditions of the comfort model to have the new missingVal.</span>
    <span class="k">if</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__airTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__radTemperature</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__windSpeed</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__relHumidity</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__metRate</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cloValue</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="k">elif</span> <span class="n">missingInput</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__externalWork</span> <span class="o">=</span> <span class="n">missingVal</span>
    <span class="c1"># Tell the comfort model to recompute now that the new values have been set.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__singleVals</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">missingVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">missingVal</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.fromEPWFile">
    <p>def <span class="ident">fromEPWFile</span>(</p><p>cls, epwFileAddress, metRate=1.1, cloValue=0.85, externalWork=0.0, inclHeader=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a PMV comfort object from the conditions within an EPW file.</p>
<p>Args:
    metRate: A value representing the metabolic rate of the human subject in met.
        1 met = resting seated. If list is empty, default is set to 1 met.
    cloValue: A lvalue representing the clothing level of the human subject in clo.
        1 clo = three-piece suit. If list is empty, default is set to 1 clo.
    externalWork: A value representing the work done by the human subject in met.
        1 met = resting seated. If list is empty, default is set to 0 met.
    header: set to "True" to have a ladybug header included in the output and set to
        "False" to remove the header.  The default is set to "True."</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.fromEPWFile', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.fromEPWFile" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromEPWFile</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">epwFileAddress</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
                <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">inclHeader</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from the conditions within an EPW file.</span>
<span class="sd">    Args:</span>
<span class="sd">        metRate: A value representing the metabolic rate of the human subject in met.</span>
<span class="sd">            1 met = resting seated. If list is empty, default is set to 1 met.</span>
<span class="sd">        cloValue: A lvalue representing the clothing level of the human subject in clo.</span>
<span class="sd">            1 clo = three-piece suit. If list is empty, default is set to 1 clo.</span>
<span class="sd">        externalWork: A value representing the work done by the human subject in met.</span>
<span class="sd">            1 met = resting seated. If list is empty, default is set to 0 met.</span>
<span class="sd">        header: set to &quot;True&quot; to have a ladybug header included in the output and set to</span>
<span class="sd">            &quot;False&quot; to remove the header.  The default is set to &quot;True.&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">epwData</span> <span class="o">=</span> <span class="n">EPW</span><span class="p">(</span><span class="n">epwFileAddress</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">dryBulbTemperature</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">windSpeed</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="n">epwData</span><span class="o">.</span><span class="n">relativeHumidity</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">inclHeader</span><span class="p">),</span> <span class="p">[</span><span class="n">metRate</span><span class="p">],</span> <span class="p">[</span><span class="n">cloValue</span><span class="p">],</span> <span class="p">[</span><span class="n">externalWork</span><span class="p">])</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.fromIndividualValues">
    <p>def <span class="ident">fromIndividualValues</span>(</p><p>cls, airTemperature=20.0, radTemperature=None, windSpeed=0.0, relHumidity=50.0, metRate=1.1, cloValue=0.85, externalWork=0.0)</p>
    </div>
    

    
  
    <div class="desc"><p>Create a PMV comfort object from individual values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.fromIndividualValues', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.fromIndividualValues" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">fromIndividualValues</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">airTemperature</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">radTemperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">windSpeed</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">relHumidity</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">metRate</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span>
                         <span class="n">cloValue</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">externalWork</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a PMV comfort object from individual values.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">airTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">airTemperature</span> <span class="o">=</span> <span class="mf">20.0</span>
    <span class="k">if</span> <span class="n">radTemperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">radTemperature</span> <span class="o">=</span> <span class="n">airTemperature</span>
    <span class="k">if</span> <span class="n">windSpeed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">windSpeed</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">relHumidity</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">relHumidity</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">pmvModel</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">airTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">radTemperature</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">windSpeed</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">relHumidity</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">metRate</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">cloValue</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">externalWork</span><span class="p">)])</span>
    <span class="n">pmvModel</span><span class="o">.</span><span class="n">__singleVals</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">pmvModel</span><span class="o">.</span><span class="n">__isDataAligned</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">pmvModel</span><span class="o">.</span><span class="n">__calcLength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">pmvModel</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="ladybug.comfort.pmv.PMV.setComfortPar">
    <p>def <span class="ident">setComfortPar</span>(</p><p>self, PPDComfortThresh=10, humidRatioUp=0.03, humidRatioLow=0, stillAirThreshold=0.1)</p>
    </div>
    

    
  
    <div class="desc"><p>Set all of the comfort parameters of the comfort model at once.  These are:
PPDComfortThresh
humidRatioUp
humidRatioLow
stillAirThreshold</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-ladybug.comfort.pmv.PMV.setComfortPar', this);">Show source &equiv;</a></p>
  <div id="source-ladybug.comfort.pmv.PMV.setComfortPar" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">setComfortPar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PPDComfortThresh</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">humidRatioUp</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">humidRatioLow</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stillAirThreshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set all of the comfort parameters of the comfort model at once.  These are:</span>
<span class="sd">        PPDComfortThresh</span>
<span class="sd">        humidRatioUp</span>
<span class="sd">        humidRatioLow</span>
<span class="sd">        stillAirThreshold</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__PPDComfortThresh</span> <span class="o">=</span> <span class="n">PPDComfortThresh</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioUp</span> <span class="o">=</span> <span class="n">humidRatioUp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__humidRatioLow</span> <span class="o">=</span> <span class="n">humidRatioLow</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__stillAirThreshold</span> <span class="o">=</span> <span class="n">stillAirThreshold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__isRecalcNeeded</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
